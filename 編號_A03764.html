<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä¿å–®è³‡ç”¢ç®¡ç† - A03764</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=LXGW+WenKai+TC:wght@300;400;700&family=Noto+Sans+TC:wght@300;400;700&family=Noto+Serif+TC:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style id="print-dynamic-style"></style>
    <style id="main-style">
        :root{--bg-color:#f3f4f6;--card-bg:#f9f6ea;--text-primary:#594a42;--font-title:'Noto Serif TC',serif;--font-body:'Noto Sans TC',sans-serif}body{background-color:var(--bg-color);background-image:radial-gradient(#e5e7eb 1px,transparent 1px);background-size:20px 20px;font-family:var(--font-body);color:var(--text-primary);overflow:hidden;position:fixed;width:100%;height:100%;touch-action:none;-webkit-user-select:none;user-select:none;overscroll-behavior:none}.font-title{font-family:var(--font-title)}.font-body{font-family:var(--font-body)}#toast-notification{position:fixed;bottom:80px;left:50%;transform:translateX(-50%) translateY(20px);background-color:rgba(45,42,38,.85);color:#fff;padding:10px 24px;border-radius:50px;font-size:.9rem;font-weight:500;opacity:0;pointer-events:none;transition:all .3s cubic-bezier(.2,.8,.2,1);z-index:2500;box-shadow:0 4px 15px rgba(0,0,0,0.15);backdrop-filter:blur(4px);font-family:'Noto Sans TC',sans-serif;letter-spacing:.05em}#toast-notification.show{opacity:1;transform:translateX(-50%) translateY(0)}.card-page-num{position:absolute;bottom:15px;right:20px;font-size:.9rem;font-weight:700;color:var(--text-primary);opacity:.4;font-family:'Noto Sans TC',monospace;z-index:50;pointer-events:none}#admin-btn{position:fixed;bottom:20px;right:20px;width:56px;height:56px;background:#2d2a26;border:3px solid #fff;border-radius:50%;display:none;align-items:center;justify-content:center;color:#fff;z-index:1000;cursor:pointer;box-shadow:0 4px 15px rgba(0,0,0,0.4);transition:all .3s}#admin-btn:hover{transform:scale(1.1);background:#4a453f}#admin-panel{position:fixed;top:0;left:0;width:100%;height:100%;background:0 0;z-index:2000;display:none;flex-direction:column;overflow:hidden;pointer-events:none}#admin-panel>*{pointer-events:auto}.admin-layout-container{pointer-events:none}.admin-editor,.admin-header,.admin-sidebar{pointer-events:auto}.admin-header{background:#fff;border-bottom:1px solid #e5e7eb;box-shadow:0 2px 10px rgba(0,0,0,0.05)}.admin-sidebar{background:#fff;border-right:1px solid #e5e7eb;overflow-y:auto;display:flex;flex-direction:column}.admin-editor{background:#f8f9fa;overflow-y:auto}.admin-card-item{padding:1rem;border-bottom:1px solid #f3f4f6;cursor:pointer;transition:background .2s;display:flex;justify-content:space-between;align-items:center}.admin-card-item:hover{background:#f9fafb}.admin-card-item.active{background:#eff6ff;border-left:4px solid #3b82f6}.form-label{display:block;font-size:.875rem;font-weight:500;color:#374151;margin-bottom:.25rem}.form-input{width:100%;padding:.5rem;border:1px solid #d1d5db;border-radius:.375rem;margin-bottom:1rem;font-family:'Noto Sans TC',sans-serif}.form-input:focus{outline:0;border-color:#3b82f6;ring:2px solid #93c5fd}.global-settings{background:#fff;border-bottom:1px solid #e5e7eb;padding:1rem;flex-shrink:0}.library-container{border:2px solid #e2e8f0;border-radius:8px;background:#fff;overflow:hidden;margin-bottom:24px}.lib-section-title{background:#f1f5f9;padding:8px 12px;font-size:.75rem;font-weight:700;color:#64748b;text-transform:uppercase;letter-spacing:.05em;border-bottom:1px solid #e2e8f0;display:flex;justify-content:space-between;align-items:center}.lib-area{padding:12px}.lib-area+.lib-section-title{border-top:1px solid #e2e8f0}.lib-item{padding:8px;border-bottom:1px solid #f1f5f9;font-size:.875rem;color:#4b5563;cursor:pointer;transition:all .2s;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.lib-item:hover{background-color:#f8fafc}.lib-item.active{background-color:#e0e7ff;color:#4338ca;font-weight:700;border-left:3px solid #4338ca}#card-stack{position:fixed;width:375px;height:660px;left:50%;top:50%;transform:translate(-50%,-50%);margin:0;z-index:100;transition:all .5s cubic-bezier(.2,.8,.2,1);touch-action:none;-webkit-user-select:none;user-select:none;will-change:transform}.card{position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--card-bg);box-shadow:0 4px 20px rgba(0,0,0,0.1);border:1px solid rgba(0,0,0,0.05);border-radius:12px;padding:2rem;display:flex;flex-direction:column;justify-content:center;align-items:center;cursor:grab;user-select:none;will-change:transform;transform-origin:50% 100%;overflow:hidden;touch-action:none;display:none}.card:active{cursor:grabbing}.card-sheen{position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(115deg,transparent 0,rgba(255,255,255,.4) 45%,rgba(255,255,255,0) 55%,transparent 100%);pointer-events:none;z-index:10;opacity:0;transition:opacity .5s ease-out;mix-blend-mode:screen}.card-content{position:relative;z-index:5;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;pointer-events:none}.back-btn{position:absolute;top:10px;left:10px;font-size:.7rem;font-family:'Noto Sans TC',sans-serif;font-weight:700;color:gray;background:rgba(255,255,255,.5);padding:2px 6px;border-radius:4px;cursor:pointer;z-index:50;text-transform:uppercase;letter-spacing:.05em;transition:all .2s;border:1px solid transparent;pointer-events:auto}.back-btn:hover{color:#333;background:rgba(255,255,255,.9);border-color:#ddd}a{pointer-events:auto}a.text-link{text-decoration:underline;text-decoration-style:dotted;text-underline-offset:4px;transition:all .2s}a.text-link:hover{opacity:.7}span[style*="color"]{display:inline}a[href]{cursor:pointer}.timeline-item{position:relative;padding-left:20px;border-left:2px solid currentColor;padding-bottom:20px}.timeline-item::before{content:'';position:absolute;left:-6px;top:5px;width:10px;height:10px;background:currentColor;border-radius:50%}.timeline-item:last-child{border-left:none}.grid-box{border:1px solid currentColor;padding:10px;border-radius:4px;text-align:center;pointer-events:auto}.key-value{display:flex;justify-content:space-between;border-bottom:1px dashed currentColor;padding:8px 0;width:100%}.bar-container{width:100%;display:flex;align-items:center;margin-bottom:8px;font-size:.8rem}.bar-label{width:30%;text-align:right;padding-right:10px;opacity:.8}.bar-track{flex:1;height:8px;background:rgba(0,0,0,0.05);border-radius:4px;overflow:hidden}.bar-fill{height:100%;background:currentColor;opacity:.7;border-radius:4px}.bar-value{width:15%;padding-left:8px;font-size:.7rem;opacity:.6}.custom-scrollbar{pointer-events:auto}.custom-scrollbar::-webkit-scrollbar{width:4px}.custom-scrollbar::-webkit-scrollbar-track{background:0 0}.custom-scrollbar::-webkit-scrollbar-thumb{background:rgba(0,0,0,0.1);border-radius:2px}.custom-scrollbar::-webkit-scrollbar-thumb:hover{background:rgba(0,0,0,0.2)}@media print{body{-webkit-print-color-adjust:exact;print-color-adjust:exact;background:#fff!important;background-image:none!important;overflow:visible!important;height:auto!important;position:relative!important;zoom:1!important}#add-page-btn,#admin-btn,#admin-panel,#close-admin-btn,#print-file-btn,#print-settings-modal,#save-file-btn,#export-json-btn,#start-overlay,#toast-notification,.back-btn,.card-sheen{display:none!important}#card-stack{position:static!important;width:100%!important;max-width:100%!important;height:auto!important;transform:none!important;display:grid!important;gap:20px;margin:0!important;padding:20px;top:auto!important;left:auto!important}.card{position:relative!important;width:100%!important;height:480px!important;top:auto!important;left:auto!important;transform:none!important;box-shadow:none!important;border:1px solid #ddd!important;page-break-inside:avoid;break-inside:avoid;margin-bottom:20px;background-color:var(--card-bg)!important;display:flex!important}.card-content{zoom:.9}a{text-decoration:none!important;color:inherit!important;pointer-events:none}}#password-section{opacity:0;transform:scale(.1) translateZ(-1000px);transition:all 2s cubic-bezier(.19,1,.22,1);display:none;pointer-events:none}#password-section.active{display:flex;opacity:1;transform:scale(1) translateZ(0);pointer-events:auto}#lock-message{display:none;flex-direction:column;align-items:center;gap:1rem;margin-top:2rem;animation:fadeIn .5s ease-in}#lock-text{cursor:default}@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}#trigger-btn{transition:opacity .5s}#access-input{letter-spacing:.1em;text-align:center}#access-input::placeholder{font-size:.8rem;letter-spacing:0;color:#a8a29e}
        
        /* â˜… ç´…æ¡†è™•ï¼šå®¢æˆ¶ç·¨è™Ÿ (ç”± JS å‹•æ…‹å¡«å…¥) */
        #client-id-display {
            margin-top: 15px;
            font-family: 'Noto Sans TC', monospace;
            font-size: 0.85rem;
            color: #a8a29e;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            font-weight: bold;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-start h-screen w-screen overflow-hidden relative">
    <button id="admin-btn" title="é€²å…¥å¾Œå°ç·¨è¼¯"><i class="fas fa-cog text-2xl"></i></button>
    <div id="toast-notification">å·²ç¶“æ˜¯ç¬¬ä¸€é å›‰ï¼</div>
    
    <div id="print-settings-modal" class="fixed inset-0 bg-black/60 z-[3000] hidden flex items-center justify-center backdrop-blur-sm"><div class="bg-white rounded-lg shadow-2xl w-full max-w-[340px] overflow-hidden"><div class="bg-gray-800 text-white px-4 py-3 flex justify-between items-center"><h3 class="text-base font-bold flex items-center gap-2"><i class="fas fa-print"></i> åˆ—å° / PDF è¨­å®š</h3><button onclick="closePrintModal()" class="text-gray-400 hover:text-white transition"><i class="fas fa-times"></i></button></div><div class="p-4 space-y-4"><div><label class="block text-xs font-bold text-gray-500 mb-2 uppercase tracking-wide">1. æª”æ¡ˆå„ªåŒ–</label><div class="grid grid-cols-2 gap-2"><label class="cursor-pointer border border-gray-200 rounded p-2 hover:border-blue-500 hover:bg-blue-50 transition flex flex-col items-center gap-1 group has-[:checked]:border-blue-600 has-[:checked]:bg-blue-50"><input type="radio" name="print_mode" value="original" class="hidden" checked=""><i class="fas fa-palette text-lg text-gray-400 group-has-[:checked]:text-blue-600"></i><span class="text-xs font-bold text-gray-700">ä¿æŒåŸæ¨£</span></label><label class="cursor-pointer border border-gray-200 rounded p-2 hover:border-red-600 hover:bg-red-600 transition flex flex-col items-center gap-1 group has-[:checked]:border-green-600 has-[:checked]:bg-green-50"><input type="radio" name="print_mode" value="compress" class="hidden"><i class="fas fa-font text-lg text-gray-400 group-hover:text-white group-has-[:checked]:text-green-600"></i><span class="text-xs font-bold text-gray-700 group-hover:text-white">è®Šæ›´å­—é«”</span></label></div></div><div><label class="block text-xs font-bold text-gray-500 mb-1 uppercase tracking-wide">2. æ’åˆ—æ–¹å¼</label><select id="print-layout" class="w-full border border-gray-300 rounded p-2 text-sm bg-white"><option value="2" selected="">ç›´å¼æ’åˆ— (2å¼µ/é )</option><option value="4">ç”°å­—æ’åˆ— (4å¼µ/é )</option></select></div></div><div class="p-3 border-t bg-gray-50 flex justify-end gap-2"><button onclick="closePrintModal()" class="px-3 py-1.5 text-gray-500 hover:bg-gray-200 rounded text-xs font-medium transition">å–æ¶ˆ</button><button onclick="executePrint()" class="px-4 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded text-xs font-bold shadow transition flex items-center gap-1"><i class="fas fa-print"></i> åˆ—å°</button></div></div></div>
    
    <div id="admin-panel" class="flex flex-row" style="display: none;"><div class="admin-header w-full h-16 flex justify-between items-center px-6 fixed top-0 left-0 z-50"><h2 class="text-xl font-bold text-gray-800 flex items-center gap-2"><i class="fas fa-edit text-blue-500"></i> 20æ¬¾ç‰ˆé¢ç·¨è¼¯å™¨</h2><div class="flex gap-3"><button id="print-file-btn" class="bg-emerald-600 text-white px-4 py-2 rounded hover:bg-emerald-700 transition shadow-sm text-sm font-bold flex items-center"><i class="fas fa-print mr-2"></i> åˆ—å°è¨­å®š</button><div class="w-[1px] h-8 bg-gray-300 mx-2"></div><button id="save-file-btn" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition shadow-sm text-sm font-bold flex items-center"><i class="fas fa-save mr-2"></i> å„²å­˜ä¸¦ä¸‹è¼‰æ–°æª”</button><div class="w-[1px] h-8 bg-gray-300 mx-2"></div><button id="export-json-btn" class="bg-amber-600 text-white px-4 py-2 rounded hover:bg-amber-700 transition shadow-sm text-sm font-bold flex items-center"><i class="fas fa-file-export mr-2"></i> åŒ¯å‡º JSON</button><div class="w-[1px] h-8 bg-gray-300 mx-2"></div><button id="add-page-btn" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition shadow-sm text-sm"><i class="fas fa-plus mr-1"></i> æ–°å¢é é¢</button><button id="close-admin-btn" class="bg-gray-800 text-white px-4 py-2 rounded hover:bg-black transition shadow-sm text-sm">é—œé–‰</button></div></div><div class="admin-layout-container flex w-full h-full pt-16"><div class="w-[35%] h-full hidden md:block"></div><div class="admin-sidebar w-full md:w-[25%] h-full flex flex-col bg-white border-r border-gray-200 shadow-sm relative z-10"><div class="global-settings"><h4 class="text-xs font-bold text-gray-500 uppercase mb-3">ğŸ¨ å…¨å±€é¢¨æ ¼è¨­å®š</h4><div class="grid grid-cols-2 gap-2 mb-2"><div><label class="text-xs text-gray-400 block mb-1">ç´™å¼µé¡è‰²</label><input type="color" id="global-paper-color" class="w-full h-8 p-0 border rounded cursor-pointer" value="#f9f6ea"></div></div></div><div class="p-4 bg-gray-50 border-b text-xs font-bold text-gray-400 uppercase tracking-wider flex-shrink-0">é é¢åˆ—è¡¨</div><div id="page-list-container" class="flex-1 overflow-y-auto custom-scrollbar"></div><div class="p-4 border-t flex-shrink-0"><button id="reset-data-btn" class="text-red-400 hover:text-red-600 text-xs underline w-full text-center">æ¢å¾©åŸå§‹ç¯„ä¾‹</button></div></div><div class="admin-editor flex-1 h-full p-8 overflow-y-auto border-l border-gray-100 bg-[#f8f9fa]"><div id="editor-empty" class="h-full flex flex-col items-center justify-center text-gray-400"><i class="fas fa-arrow-left text-4xl mb-4"></i><p>è«‹é»é¸å·¦å´é é¢é–‹å§‹ç·¨è¼¯</p></div><div id="editor-form" class="hidden w-full bg-white p-6 rounded-xl shadow-sm border border-gray-200"><div class="flex justify-between items-center mb-6 pb-4 border-b"><h3 class="text-lg font-bold text-gray-800">ç·¨è¼¯é é¢å…§å®¹</h3><span id="editing-id-display" class="text-xs text-gray-400 font-mono"></span></div><div class="grid grid-cols-2 gap-6"><div><label class="form-label">ç‰ˆå‹é¸æ“‡</label><select id="edit-type" class="form-input bg-gray-50 font-bold text-gray-700 text-sm"><optgroup label="åŠŸèƒ½é é¢"><option value="total_toc">â˜… è‡ªå‹•ç¸½ç›®éŒ„ (Auto TOC)</option><option value="cover">1. å°é¢ (Cover)</option><option value="intro">2. å‰è¨€/æ•˜è¿° (Intro)</option><option value="toc">3. æ‰‹å‹•ç›®éŒ„ (Manual Index)</option><option value="chapter">4. ç« ç¯€é  (Chapter)</option><option value="quote">5. é‡‘å¥ (Quote)</option></optgroup><optgroup label="æ¸…å–®èˆ‡æ¢åˆ—"><option value="standard">6. é …ç›®æ¸…å–® (Bullets)</option><option value="numbered">7. æ•¸å­—æ¸…å–® (1.2.3)</option><option value="checklist">8. æª¢æŸ¥è¡¨ (Checklist)</option><option value="grid">9. ç¶²æ ¼åœ–æ¨™ (Grid 4)</option><option value="grid3">10. ç¶²æ ¼åœ–æ¨™ (Grid 3)</option></optgroup><optgroup label="è³‡è¨Šåœ–è¡¨"><option value="stat">11. é—œéµæ•¸å­— (Big Stat)</option><option value="keyvalue">12. è¦æ ¼æ•¸å€¼ (Specs)</option><option value="chart">13. ç°¡æ˜“é•·æ¢åœ– (Chart)</option><option value="comparison">14. å°ç…§æ¯”è¼ƒ (VS)</option><option value="table">15. è¡¨æ ¼ (Table)</option></optgroup><optgroup label="æµç¨‹èˆ‡å…¶ä»–"><option value="timeline">16. å‚ç›´æ™‚é–“è»¸ (Timeline)</option><option value="process">17. æ©«å‘æµç¨‹ (Process)</option><option value="qa">18. å•èˆ‡ç­” (Q&A)</option><option value="warning">19. è­¦èª/æ³¨æ„ (Warning)</option><option value="contact">20. åç‰‡/çµå°¾ (Contact)</option></optgroup></select></div><div><label class="form-label">ä¸»é¡Œè‰²ç³»</label><div class="flex items-center gap-2"><input type="color" id="edit-color" class="h-[42px] w-[60px] cursor-pointer border rounded p-1"><span class="text-xs text-gray-400">é»æ“Šæ›´æ›æ–‡å­—èˆ‡è£é£¾é¡è‰²</span></div></div></div><div class="grid grid-cols-3 gap-6"><div class="col-span-2"><label class="form-label">ä¸»æ¨™é¡Œ</label><input type="text" id="edit-title" class="form-input font-bold mb-2" placeholder="è¼¸å…¥æ¨™é¡Œå…§å®¹..."><div class="flex items-center gap-2"><label class="text-xs text-gray-500">ç¸®æ”¾æ¯”ä¾‹ï¼š</label><select id="edit-title-scale" class="form-input w-32 mb-0 text-sm bg-gray-50 cursor-pointer font-mono text-center p-1 h-8 py-0"><option value="70">70%</option><option value="80">80%</option><option value="90">90%</option><option value="100">100%</option><option value="110">110%</option><option value="120">120%</option><option value="custom">è‡ªè¨‚ %...</option></select></div></div><div><label class="form-label">å´é‚Šæ¨™ç±¤/å°æ¨™</label><input type="text" id="edit-tag" class="form-input"></div></div><div class="library-container"><div class="lib-section-title text-green-700 bg-green-50 border-green-200 flex justify-between items-center"><span><i class="fas fa-plus-circle mr-1"></i> æ–°å¢è³‡æ–™åˆ°é¡Œåº«</span><button onclick="lib_add_new()" class="bg-green-600 text-white px-3 py-1 rounded text-xs font-bold shadow hover:bg-green-700 whitespace-nowrap"><i class="fas fa-save"></i> å­˜å…¥</button></div><div class="lib-area bg-green-50/30"><div class="flex flex-col gap-2"><div class="relative"><textarea id="lib-new-content" placeholder="è«‹åœ¨æ­¤è¼¸å…¥æˆ–è²¼ä¸Šæ–‡å­— (é‡è¤‡å…§å®¹å°‡è¢«æ‹’çµ•)..." class="w-full h-16 text-sm border border-gray-300 rounded p-2 focus:outline-none focus:border-green-500 resize-none font-mono"></textarea></div></div></div><div class="lib-section-title text-indigo-700 bg-indigo-50 border-indigo-200"><span><i class="fas fa-list-ul mr-1"></i> é¡Œåº«åˆ—è¡¨ (é»é¸ä»¥åç™½)</span></div><div class="lib-area bg-indigo-50/30"><div id="lib-list-container" class="bg-white border border-gray-300 rounded overflow-y-auto custom-scrollbar mb-2" style="height: 160px;"></div><div class="flex gap-2"><button onclick="lib_insert_at_cursor()" class="flex-1 bg-indigo-600 text-white px-3 py-2 rounded text-sm font-bold shadow hover:bg-indigo-700 transition flex items-center justify-center gap-2"><i class="fas fa-mouse-pointer"></i> æ’å…¥æ–‡å­—</button><button onclick="lib_delete()" class="flex-1 bg-white text-red-500 hover:bg-red-50 px-3 py-2 rounded border border-red-200 text-sm font-bold shadow-sm transition flex items-center justify-center gap-2" title="åˆªé™¤é¸ä¸­çš„é¡Œåº«"><i class="fas fa-trash-alt"></i> åˆªé™¤</button></div></div></div><label class="form-label flex justify-between items-end"><div>å…§å®¹ç·¨è¼¯ <span class="text-xs text-orange-500 ml-2">(èªæ³•ï¼šæ–‡å­—## é€£çµ | [link:..] | [color:..])</span></div><div class="flex items-center gap-2 bg-gray-100 px-2 py-1 rounded border border-gray-200"><button onclick="insertLink()" class="text-gray-600 hover:text-blue-600 hover:bg-white p-1 rounded transition" title="æ’å…¥è¶…é€£çµ"><i class="fas fa-link"></i></button><div class="w-[1px] h-4 bg-gray-300"></div><label class="flex items-center gap-1 cursor-pointer text-gray-600 hover:text-gray-900"><i class="fas fa-palette text-sm"></i><input type="color" id="text-color-picker" class="w-5 h-5 p-0 border-0 bg-transparent cursor-pointer" value="#000000" onchange="insertColorCode(this.value)"></label></div></label><div id="hint-text" class="text-xs font-normal text-gray-500 mt-1 bg-yellow-50 p-2 rounded border border-yellow-100 mb-2">æç¤ºå€</div><textarea id="edit-content" class="form-input h-48 font-mono text-sm leading-relaxed"></textarea><div class="flex justify-end pt-4 border-t mt-4 gap-3"><button id="delete-page-btn" class="px-4 py-2 text-red-500 hover:bg-red-50 rounded transition text-sm">åˆªé™¤æ­¤é </button><button id="apply-change-btn" class="px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition shadow">ç¢ºèªä¿®æ”¹ (æš«å­˜)</button></div></div></div></div></div>

    <div id="start-overlay" class="fixed top-0 left-0 w-full h-full bg-[#fdfcf8] z-[1500] flex flex-col justify-center items-center transition-opacity duration-500" style="opacity: 1; display: flex;"><div class="text-center p-8 border-y border-stone-200"><h1 class="text-4xl font-bold text-stone-700 mb-2 tracking-widest font-title">ä¿å–®è³‡ç”¢ç®¡ç†</h1><p class="text-sm text-stone-400 tracking-[0.5em] font-body">20 STYLES COLLECTION</p></div><button id="trigger-btn" onclick="startPasswordAnimation()" class="mt-12 px-12 py-3 border border-stone-600 text-stone-600 hover:bg-stone-600 hover:text-white transition-all rounded-sm tracking-widest font-body">é–‹å§‹ç¿»é–±</button>
        
        <div id="client-id-display">Client ID: A03764</div>

        <div id="password-section" class="mt-8 flex flex-col items-center gap-4 w-full max-w-[280px]"><div class="relative w-full"><input type="password" id="access-input" placeholder="è«‹è¼¸å…¥å¯†ç¢¼" class="w-full px-4 py-3 border border-stone-300 rounded bg-[#fdfcf8] focus:border-stone-500 focus:ring-1 focus:ring-stone-500 outline-none transition text-stone-700 placeholder-stone-400"></div><button id="submit-pass-btn" onclick="checkPassword()" class="w-full px-8 py-3 bg-stone-700 text-white hover:bg-stone-900 transition-all rounded-sm tracking-widest font-body">ç¢ºèªé€²å…¥</button><p id="error-msg" class="text-red-500 text-xs tracking-wider opacity-0 transition-opacity">å¯†ç¢¼éŒ¯èª¤</p></div><div id="lock-message"><p id="lock-text" class="text-red-600 text-xl font-bold tracking-widest cursor-pointer select-none">éŒ¯èª¤å·²é”3æ¬¡ï¼Œæª”æ¡ˆé–ä½!</p></div></div>
    <div id="card-stack"></div>

    <script id="main-script">
        const _p_h = "6d9d42616fda82088254176d81898f0c807cee4f008c1a90ef07d20199e45177";
        const _a_h = "80ce719a659f90e18789655dba406636a9d64e6fd1fc8bb041f527362b60bdb7"; // â˜… ç®¡ç†å“¡å¯†ç¢¼ SHA-256 é›œæ¹Š
        window.encryptedData = {"c":"e8bcb2919488a5a2ccd10df6c3cbc0ac9549b7f551f2d3d3706ca50d280e56c42262f88d3a5dab25c62e84e344bf443ea270b84d1f3fb24f158df8d9172652b7db9e20fcc4981e9fbf71df1a2edcdb7f6497732825b863693850cb1e5c8e858eb23bf649b04be091159bfeb61e76b57bca4be554e94cf5f5d1f6ce35ef18fd640961f0c61f2b0a407e6b6c6694f64fd36172bfe68c3b5157241ee98cd3580de3b0c93ecfaebe65cae0ff85a4c4dc8bb868c201dac6307bf4181feb290d74180741d04d2c749f6f4b28889eb2119b4f8aea972513c92b49e75bb92a9f2b31f7a378c722b088d733c946d21e5c60fbc07248d9d2373f2405d11a060cb8f00e3aad7f6c23df76a1e2e5dc4cf0336a1056bf7753c4c3753f32d5992eeb8d2be0281ae203592da481465175ebf48344b5d3c41789642b9d8ac4741ed089d8c6d1d68552b991030a58609dfcdad76524935d8699201da0a7cb3ff9cac31f39a0c44957123b43b19ae4320b8042182f6bed488845131f81b18369b6e024836056179f9a804b9c42d77349b8b37b0ccf45358cdc429cbd216d12eaa3387b41a1a2d5116f7c1fccd904406c21b12ee49a28868c3b59e4c4b42e2ef3ebf2fc57ecd9d29e555eeba275ac01c56555fdec419c7b542564e532bb5291bd08090d9f6f47bec707622d4381902794ac0f373c4847e3cd339f225c307b0c1b27f2d874e9b9d9dc9e29dfa4f44d6ac154fc4cb499e229a6a9cfaed76e69b9072dc3b83efddfac81d46b02e1706bc3f70c15da78f3f29e4bdb5cd9e80fe51aa6d45aae0ca71f3971b3baf005050ef97d39183f54dcc5b6e514ab22553878f65310ee27e79c469d668d2d1024c8a5cbf93ceccd74cc1981c6df7f534831fe70340b673f6c0b48d09728d94c35b7ed29a07daac7aff257acc7997b75b4a1a30840fe0e7923ef265bc791c5697cadc17bb25040b69104f746d58f89a5734db1314566631d9950a69851aec95c14e25109bc124eb4e7781b9a3e43b18abe80fb81a516e400926b6c46087005a4d667d780ec934882e9a970cded963d2a6958628bee455d9d915f3938c1fa2ce0100764f8d4961cf525bf9aae38265593ed093314e46ca50419419c1e3de904f0369d57e6b64cd9a87193077a142c84ffa7a65842409dfc5b4b3b50519e9acee40dd71a6b4817627c7623956d06e43a422caa242f32cde40bb8d2dc081486b839d9cb8a5fec6538a491afd411616b563d35b4657fe69c9fefebe4b46164277dbb17175a843c8bac0b56533a4a5013704ce5b411ac5d8b35c770b7270fc4f18833a0b024370c89ff5e5b0ebc1467595dc445d6365311ab080506dea09fe7ac9a802e1dcce5631babc7fb97e0e37eae9dfc5280771d6d9951435b89f3d0667eec2a019709698e98885ed84e0dd4cf68ae772fddc55024ce108030769961bb0f672f858f2346edc7a9f38844a56477fc43782dca30f2292f6ab121ae0cc713f6f6bfc7a23c8862085f35b178096b402361191028eed7593448909e69269bc00f5adf13e2f6c0ed431e3aedb8bfd768eeb86ce92f42526627e040c620d9f157f98aa9b55aadb540ca9b7ff7ae6d37e38a8b72bcddbe2efb8306709643a9b2bab08c21219e698d66b5e857e623f288a8f77b5aa7b83945e49bfca43a3a40834192f8d4879815c7cc430b15632472249ca576afed2f9c34c7b842de467ea78dec16b1fcd392d10bff5f02a1adee52c25db012dc4fb2eb28111200d33d383bb38250844bc35901dfa4a4705336a64f002af168245ac29c3ab306bce5fb85e930a07a4c8e02c0ae68234dedf926f23c2261474d352a97918df4573afb77f16cc1e6be9270c492f414cf91c24d70093e601ace36c9e0811b99774b395ef95d4a22fc59e30b108d9ac6312d1d78c0b778aaf20aca0cb13c52ccb765f06abbf822d3597a674912836c22b31e6f8c703002748d4fb45c5b9eba4367811e0baa1e11c568c1e66967fcf575e7a3ffde011cba0757898382f6ebee63f6a61b77e85f87195a0accd622323763bd715d12813277429b1a654cf4a151cb087e5cc1f5413a14ed141a42c7a6e6598770582879c11da2cbe278e7ebfe10a149515529d37819f78e44ce0dcf8c8a983d0ccc3579ad938456ad54673bc9f151aa4ff966117879ecb257c657c60d329de3aa2c72dd5ce8849bf2e6d38e8a7e8533dbfad1404944c9604b39c01c9ce962cadc680ca89be4af1c17561801623f2f237692fbc5f0100eb2d011ffc83674785b6f216f88968e9219076d6173ead52e1931074f361cbec18a1c1d1476d139c3c7c54ddbe8ff4a1e94920918889aa677dd9747a2f37ad1bca9d042af01e93efd223d69add780e1a5eb87574140c239a2ffab3f8dcd09fed6ae54fe2db97ae27c258e67aff879b9dc667fe9430a0df209ebe81e23bc2159b814d03e0bfca40210bc355f3a95f87cbfbf2e410da04b36b0987039be3d152d820e4901eaabb5eb07bfb973268f8292493ca789fd41c652946ac4de8b054740869bf87c7ceae9164b2787b83734a2ddcf89cf60a10ae0c75c7a65cada58269da49225319869709b9ed1222efa5188285209523f1dca7f4f1e97b85498149c60fdf5b51795c4b451a6dae169d4261b46e1443358e8ffc7be227dd2f86b5a13d1c6b41695530992dc8cafa8c0e380acd3cb53e0487cd9633f513cc572f69797efd6ffc0a601761c2364fad95791af4a729b79a36dacdb21757da7508ff3a938133a3bedc4588890f52fc2798f8a3d826980601b216d9b2436d038e0d871400d96149791e55f81a1795d5df15c863987b0cdb3133777cca2fa20c4f7d2dfbf7a26147348a7de8dfbd9143709e6feb9aed342811b577ed083901e7fcd11e84643ddba2be59f0198a0aeb18f378d8e63167f8fe53f8312e737ef528a672b528514292f72b0426978d4e8c944e36345e214dc8b5348a4543368218273f9c28236d3925c40727f01551e0e80920e22005242511ef195f622d727df2adfbb32c27dc2e2b72de1a45e13af46c8443e55e742ccfb5e5bff45dee192c79954351fde66d011e98f9a0a216ec219f6c95109959ac9708603b80d92f4314e4a2a8bf950b3e76d36552bcab1decdd8a843c0c3d77a3dd9cf01a042e5f47327d5bef87aa27c26bbb0bda8ce0a45983350b5dd2c59902ddf8d3e88a9b21d9cc74eaa23c8bf3c1f2dc249abce0fac3462127cf8adb5e81a33515d6b86641cb4e8285ac105fd03e4af24f3a3f7d8bedc043b387771ff9168d6508f66c88252e2d0c8458484e89511b970af558b572c04acbe6af11bf0550c3d89b8720804ec7bcfffca0aca06d340207f81d9e575774e4ac3f3768e20640f60f1426ecd7ea3968059628149259fe871be58d121b671d733eca8026d9359934725e6704e3de95c74c52d782e48c01e2f59c3acd7494de27e305fce31cdf5dfc6bea81279910f13af5c2bf389ac190fc2ad78dc1fccff2f3f037b2c074b8592e9c0f9c29854b628a420b692c75bf445b9891873eb459c8edf574057979c5e3be736d069ed3e59b14e54220fbad6a746e1c302bbb697859b0eb7d07bf1d08ef914eced1642035a4db55d51e7f495915903de95fc48af3178b3c639f503d5ec00aea5a91cbebaf98bd99467af82d837a690735f014e2d76cd12810cd4347443b2155f195be88c60a780ddba473d42ecd66737e6ab0c5b3b966ef548e99867ecbab8f5dbdf050212b594ae74ede0f690a9ba60a20d651b3168df9080586a40a764ee661b456c98af09a2930c51cf411b0615093f7322d314c7a9b7e9e043ce0be22bfebed930ba537a7de062f223837a497db96ec75a57ca3f0c5eda749de10d6393777e18be8e2fa2b7ca96e15d28e77fda856a4c10c5b539ef9ee1e2b24d9bf11c04b7e43a7736bc63c1cf65a9873f9f57d75f4f7984c8727d0e0b4340468d75fe318f57ec9b59d09e6bf67750e8d744b37a73a6fcf27151545565bc2f9879aa76bee2ad753d46f48bf38968a28a05ce3647fcd9e488ca5fab6ffa2975d7a0fc543360860a0f2480af3d0fb78dd4f5db4b2cf9fc89393cd39c62123af4c2d666df09f21c5f51f4c430c42436d61d73276b3f7641973f0a0eb158b4bd319b7733a3691ebf26a792a8dfebbc7c20c909b3a9ce6e6058964872cff55767db6bcc005d251d40cab3d040192fb6c603e89c5e78175522f78c48d4ab4171eb33e8476ac81219d640ece8fd21d30c8687ad701f897e10debff9ab3fcfbec1386bee874d955948d495c4bf0aa06da0aa3b512db363cbb384fc188770897b55e5dc9bd19392fd6c199ff9f5c9bc021397e01e497266f943ad74a3942e9657f8a314e0ae41ca12ff936a552919c6da18abe77c4b1704a4ca1012f34a1b7b2acc99d5dfe6c9bd78f32d5b1bd8a97cab0576438b3c3b346f22e1d2bf86f8d5cdfc8f50f2837e4e20fda93bfc33c42380e5162385073a5595eeb31ecba852fed219d096ca70621ffe2721d7cd925a07d475c5e20bebca2633fcfde302eaf607a9f9f1af4a849297e2441ee79931a2ceef75f34fe41ef3406f6bd1909a1a12764c47bf9ca6dda9ae335fd3f1b9a11bcc84b0c2d1b90cd10af05215363d24c218c1033189db476183e00e450f4a50e3254221dbcf39d56d975ba87e6a52fcfa734d108ff559ecbef34022eb9d04117341c6aca98e44e3b1d5a0b1611acbe484cc02dc791f6c7162b5cda2e6b42f3435cb3ef8d538315b74b9a88d9a03b9bf15844b0b8e93fa6aeb5c2df8c8f2ea517f1bebccaaadef61ea5b913a68838d962af75b174afaa75a92345519b53171c59246125a95d5349678a897f2bdfccb4b5ebbbdee6d190c8aec1c712f872dbe85a3ff48809321376a8e4864587ea75b164a886b3f4c7b51e832c0689aef0328ca74cddc3361dc12b1c20baf6b5f8627db89ec53cd2a82de720ab8d38fbfb55ea770025c3505563cb9999fa5fb33b16852cef7206b93149f58e672235bcbb1e503d307f634ec19a256d66e4b49d11157754fc43bc0b5d157f16cbca21d2f3d04b3e1100da4a3bcf3f352e23244d3662a80c96f9823ed0dee3e48e3926114d90c010888703ffa5497c394210063d1ff0ec283cd149a5fe99004de6ee743d21171d7524961a42199dbd5c3b07041b074090a8ecf932d740fb0943661510f08ab557827d286d8dcebca6581bac72a2a5308dcee6c87a801cb50c756b72b6820e2b0d199c5741e02f1a13c27ee297e0f4556265bb4adbfec2259f94eeaabd618760ad9be4d2af47ce4afef427769f7ac49f9b80d128eaa308bb8fcb11909e81002a00800fafba701e0e7b6032bf63868b7adfc63b608a333de55c4d147bf6db2aa35d5d839f23628f6053f12c0a8ed0427b445eede92c66d9c3563302248e1f390ad1a657c9446a4f5c194cd1b04aeac772fc991a706bf1d8836598ff5c409c960482a6c3a27c5821ae11958450bbc4b291c82a51e6662f1079d36c398fc10be704ca52de7c564b6fc5f05cb23805959e334684a62d167697583ba9c9685b47d51bcf8491140c3bc653c46123cc04d076a2b0ff00d294f0c08b719f40ee81c9891c35ecf0a014337194390c93f4ed6d415f9c5d7f31f8857447626f37a4c08fc7bcefa109269ddb22eb9fff8e740d9ea7c98e6983c1d7f10c9292e39b608528fee74dd2fcf6e78c9082d56eac8ea99f9bd8f9e2aa8d548738d5ad78228a65fbcb9acf65b868e5aeebd7b076cb92ba83671fd4df50b79f777bfe76ae0d452c3a310b4bfe6d5a84ce9ca9d11b8971785e466c34ff83936b32abdc00bdec4b031a493fbb4e56d94262a9bb3b683d926aa78a2b9cc390dff96fb716cf116f17a00ecb4b754647e121de375fef86e75f4af38d580f0c7fe6bc40a21c70d25ad9d6a05150aeee9a70da42cc960c1ccba275a80df81e51ff67d1f8a66d0204bcd3837c10a1127dd2b83378b014312dd97988aad980147a28ee184c68dd90938a7c1242e48a7110f12c5160e423062dd3df962851ce74fda314e8d376b0e286934475532b8d9912aa498ba1ca2284d199c64c895cd3e6c87bad74f10ecde958f4919a25df05bdf2be4a4f2dfb0eefe45a04be0764922458f39302da315a80eec5df152867114d0a782fac71d3b51d8ca1d3cafcb1902ef61491c091ee43710ce3b1e8974f82a633bfd08106fc6e60c14a155df0d587f95f71c86ce1d06424d51fa4b901dcfec4fa0bd74850bbaf5e5238412d22ffc0602bca212a3df9adefe2d2241f02ab84fefc24c091627f413191264326ecad5945686faea0cdbac1c801253934f3ad5ca9f2d7df57098b3702a51e2368bb8eb3977eb35eac4bfd47d9b0c12497f66e21ae71be486cd5098d00ac6c9d56dd6f76a3df0bdff92dd0e4b91521821f1b338599a49d6d257832aa39a5478f9d9fd2fdf8209185f83a14158371b919e5c1bb26948ef24077b5e9444a8404763801a64250c69406ad77b2e72ee912799e662755f6abec248fa84189ec2c14d01e5d8e8648e50781414f59eed548f0ed7174cd2b183a812bb6433cd41210aab4c0729cbf58dcd9715c14d929301df59ed6b81dfb0f5f4bd1e2c1d706fba4a3dc2e05a6822ebeb2ba9f6947bd92199ceecf60963da737ddc641b087e5b2f0176fc65b036f2bdf3129a40a195602bfe21fd659e9af76f86fe87b125e27fefd908d9c03ae4fc56b5681a4928a67c4965dcd6740d1cb22c5621da12c9c6f8e85beec9c4fe6bf6b0b227133fb3eecf655f45637275b3fca1da3ad52558446b90960eb268cd3b573a87e5d5200381956b50b0cd8f6d18fdbbac501a32a913e21981e86a063ece7e0e285d6a96823689438e7f32bd19bf0fe2f2ac436af016253f12bce5db3ee0c8672d02c66cd0078f40da5fc02b9bcbbc31e37118afd787abb2d7e80a6e29014f9571b88b0ed84a1396cd6045a8fb8db4de49cf5ea4ac22c533d34226e04c201303b73e87bbff14a6f7b7a0d34aef0b34d4c2c58bc0d2279a68705e023cb47cf2db780a359e6a4a6096bfcdbbe0fd2ecc92cca75daadbbc644c388547a6a10851d0e3475ff50c650de001fc5a0d85395a133baefdc33ddaeb542c7081282b60de42e68fb49db7ca4c9c40ddca6fafbc5aba6e2cc9afbd32d531c7ddf28e0ab7d8ecf31bc8ad49d845e5fd334580fa543ae42513427a561cb595146ee65c548ccd2c42776d80ee7cca02cab49e65a5705f710b0e5c0c2274962be07f16522c66b0dc3d1fe0db85ae87c5842ba126b173381adb2a54a62e38c812f32501a9f6102f04f6ad5eabbe40aee863658a59b712a68e7a03fb066a9e6833bdd590511b110b23efa52796bb11f17db1b8ffd609e35a0237ebe77166fcc415b405a0366593e54c7ac49a8a5ed51dc103be45d4f8933530af297693c95488572eb070737fe5b091553c795e403654f6da9874034412e6e5b1d327aa2295b08204ec1d5cce0704e1ae4289125bc7ac3759489ad1c30a3aa06863130638a16b5584ca48e5bcf2205fffc0babdaf4941d5f0df731dc65d8edf1440a9851269046c211078452a4448c7f2d0f6d7bfecbd6ad7d46156cca60aa8bdcc43a6b9972c671a9aada59a3a0c103176b646b6de10675df2f7b622b26cdb51e8e2b4b67bf589bca49e6653e4e8b6d3f94a1c0abd24a59c8795d008e74a85fe2bcc6b611c4be13502cd282bf381e41a19c25e9595f7dde148e1f136b02c4d4aab0af528e7d7380ea4cc087a8d8583c57611f83322dee02a16f0b0f271809c97f214ba5abf5f75926b8a063bd0245419238e90feeaa0a73f9503ffd073212145295bde9cb78854fc36df06c4509bffdc6b41ea7eb9cafb543391e9469af6cdd44197ea077863d9944c1e28bb3cae0d2387f0384d2ae5b6ba15ad50480f82a02ca8c5884711bff69b83193a1699ff9d57d61b667333dd2eefac2055cdbb6e7eb1c136784a985a135c0f2245d1bfd2ae6565b78543c5580269073feb429395b3c6c6b5252d6cdc9304d22b5e89d8c36c18b8fcd493d80b6f1af1e80225ff6af3","s":"a370ed6aaf4233f52dfe4557888e629b","i":"ab3ea647a883f60521ec24a7"};
        
        let isVIP=false,passwordAttempts=0,unlockClickCount=0;const MAX_ATTEMPTS=3;
        
        window.bakedData=null;let cardsData=[],styleConfig={},textLibrary=[];
        const defaultStyle={fontTitle:"'Noto Serif TC', serif",fontBody:"'Noto Sans TC', sans-serif",paperColor:"#f9f6ea",textureOpacity:"0.5"};
        let currentScaleFactor=1,viewingStartIndex=0,currentEditId=null,selectedLibIndex=-1;
        const hex2buf=(h)=>new Uint8Array(h.match(/.{1,2}/g).map(b=>parseInt(b,16)));

        async function checkPassword(){
            if(passwordAttempts>=MAX_ATTEMPTS)return;
            const input=document.getElementById('access-input').value.trim();
            const errorMsg=document.getElementById('error-msg');
            const enc=new TextEncoder();
            if(!input)return;
            try{
                const hBuf=await window.crypto.subtle.digest("SHA-256",enc.encode(input));
                const hHex=[...new Uint8Array(hBuf)].map(x=>x.toString(16).padStart(2,'0')).join('');
                if(hHex===_p_h){
                    await decryptAndLoad(input);
                    passwordAttempts=0;
                    document.getElementById('start-overlay').style.opacity=0;
                    setTimeout(()=>document.getElementById('start-overlay').style.display='none',500);
                    // ä¸€èˆ¬ç”¨æˆ¶ç™»å…¥ï¼Œå…ˆä¸çµ¦ VIP
                    isVIP=false;
                }else{throw new Error("Password mismatch");}
            }catch(e){
                passwordAttempts++;errorMsg.innerText=`å¯†ç¢¼éŒ¯èª¤ ${passwordAttempts} æ¬¡`;errorMsg.style.opacity=1;
                document.getElementById('access-input').value='';document.getElementById('access-input').focus();
                if(passwordAttempts>=MAX_ATTEMPTS)lockSystem();
            }
        }
        async function decryptAndLoad(p){
            try{
                if(!window.encryptedData){alert("No data");return;}
                const d=window.encryptedData;
                const enc=new TextEncoder();
                const kMat=await window.crypto.subtle.importKey("raw",enc.encode(p),{name:"PBKDF2"},false,["deriveKey"]);
                const key=await window.crypto.subtle.deriveKey({"name":"PBKDF2",salt:hex2buf(d.s),iterations:100000,hash:"SHA-256"},kMat,{"name":"AES-GCM",length:256},true,["decrypt"]);
                const decBuf=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:hex2buf(d.i)},key,hex2buf(d.c));
                window.bakedData=JSON.parse(new TextDecoder().decode(decBuf));
                initData();
            }catch(e){alert("Decryption failed");console.error(e);}
        }
        
        function initData(){
            if(window.bakedData){cardsData=window.bakedData.cards||[];styleConfig=window.bakedData.style||defaultStyle;textLibrary=window.bakedData.library||[];}else{return;}
            applyStyles();
            renderCards();
            initStackInteraction(); 
            renderSidebar();initAdminUI();renderLibraryList();adjustLayout();
        }
        function adjustLayout(){const w=window.innerWidth,h=window.innerHeight,s=document.getElementById('card-stack'),ap=document.getElementById('admin-panel');if(ap.style.display==='flex'){const lc=w*0.35,sc=Math.min((lc*0.85)/360,0.8);s.style.left=(lc/2)+'px';s.style.top=(h*0.55)+'px';s.style.transform=`translate(-50%, -50%) scale(${sc})`;currentScaleFactor=sc;return;}const isP=h>w,sc=isP?(w*0.96)/375:Math.min((h*0.95)/660,1.2);currentScaleFactor=Math.max(0.6,Math.min(sc,2.0));s.style.left='50%';s.style.top='50%';s.style.transform=`translate(-50%, -50%) scale(${currentScaleFactor})`;}
        window.addEventListener('resize',adjustLayout);
        function applyStyles(){document.documentElement.style.setProperty('--card-bg',styleConfig.paperColor);document.getElementById('global-paper-color').value=styleConfig.paperColor;}
        function updateMemoryState(){applyStyles();renderCards();renderSidebar();}
        function startPasswordAnimation(){document.getElementById('trigger-btn').style.opacity='0';document.getElementById('trigger-btn').style.pointerEvents='none';const ps=document.getElementById('password-section');ps.style.display='flex';setTimeout(()=>{ps.classList.add('active');setTimeout(()=>{const i=document.getElementById('access-input');if(i.style.display!=='none')i.focus();},2000);},50);}
        function lockSystem(){document.getElementById('password-section').style.display='none';document.getElementById('password-section').classList.remove('active');document.getElementById('lock-message').style.display='flex';}
        document.getElementById('lock-text').addEventListener('click',function(e){e.preventDefault();unlockClickCount++;if(unlockClickCount>=5){unlockClickCount=0;passwordAttempts=0;document.getElementById('lock-message').style.display='none';document.getElementById('error-msg').style.opacity=0;document.getElementById('access-input').value='';startPasswordAnimation();}});
        document.getElementById('access-input').addEventListener('keypress',function(e){if(e.key==='Enter')checkPassword();});
        function renderCards(){const c=document.getElementById('card-stack');c.innerHTML='';cardsData.forEach((d,i)=>{const card=document.createElement('div');card.className='card';if(d.type==='total_toc')card.classList.add('print-full-page');card.style.setProperty('--text-color',d.color||'#594a42');card.style.color='var(--text-color)';let inner=`<div class="card-sheen"></div><div class="card-content w-full h-full relative"><div class="card-page-num">${i+1}</div>`;if(d.type!=='total_toc')inner+=`<button onclick="jumpToTOC()" class="back-btn" title="Back">back</button>`;if(!['cover','chapter','total_toc'].includes(d.type))inner+=`<div class="absolute top-6 right-6 writing-vertical text-xs tracking-widest opacity-50 border-l border-current pl-2" style="writing-mode: vertical-rl; border-color: var(--text-color);">${d.tag||''}</div>`;
        const parseLink=s=>{if(!s)return{text:'',url:'#'};const p=s.split('##');let t=p[0].trim().replace(/\[link:(.*?)\](.*?)\[\/link\]/g,'<a href="$1" target="_blank" style="text-decoration:underline;">$2</a>').replace(/\[color:(.*?)\](.*?)\[\/color\]/g,'<span style="color:$1">${2}</span>');return{text:t,url:p[1]?p[1].trim():null};};
        const getTitle=t=>`<span style="font-size:${d.titleScale||'100'}%">${t}</span>`;
        switch(d.type){
            case 'total_toc':inner+=`<div class="w-full h-full flex flex-col pt-16 px-8 overflow-hidden"><h2 class="text-2xl font-bold mb-6 tracking-widest text-center font-title border-b border-current pb-4">${getTitle(d.title)}</h2><div class="overflow-y-auto pr-2 space-y-3 h-full custom-scrollbar">`+cardsData.map((c,x)=>c.id===d.id?'':`<div onclick="jumpToCard('${c.id}')" class="cursor-pointer border-b border-dotted border-current/30 pb-1 hover:bg-black/5 transition flex justify-between items-end"><span class="text-sm font-bold opacity-80 truncate mr-2">${c.title||'ç„¡æ¨™é¡Œ'}</span><span class="text-xs opacity-50 font-mono">P.${x+1}</span></div>`).join('')+`</div></div>`;break;
            case 'cover':{const{text,url}=parseLink(d.content);inner+=`<div class="flex flex-col items-center justify-center h-full text-center px-4"><div class="mb-4 text-xs tracking-[0.4em] opacity-60 border-b border-current pb-2" style="border-color: var(--text-color);">${d.tag||'COVER'}</div><h1 class="text-5xl font-bold mb-6 tracking-widest leading-snug font-title">${getTitle(d.title)}</h1><div class="w-12 h-1 bg-current opacity-20 mb-8"></div><p class="text-xl font-serif italic tracking-widest opacity-80 whitespace-pre-wrap font-body">${url?`<a href="${url}" target="_blank" class="text-link">${text}</a>`:text}</p></div>`;break;}
            case 'intro':inner+=`<div class="w-full h-full flex flex-col pt-16 px-8"><h2 class="text-3xl font-bold mb-8 tracking-widest font-title">${getTitle(d.title)}</h2><div class="text-base leading-loose text-left opacity-90 whitespace-pre-wrap font-body">${parseLink(d.content).text}</div></div>`;break;
            case 'toc':inner+=`<div class="w-full h-full flex flex-col pt-16 px-8"><h2 class="text-2xl font-bold mb-10 tracking-widest border-b border-current pb-4 text-center font-title">${getTitle(d.title)}</h2><div class="space-y-4 font-body">`+(d.list||[]).map(l=>{const{text,url}=parseLink(l);return`<div class="flex items-end"><span class="font-bold opacity-80">${text}</span><div class="flex-grow border-b-2 border-dotted border-current opacity-30 mx-2 mb-1"></div><span class="font-serif opacity-60">${url||''}</span></div>`}).join('')+`</div></div>`;break;
            case 'chapter':inner+=`<div class="w-full h-full flex flex-col items-center justify-center relative overflow-hidden"><div class="absolute text-[200px] font-serif opacity-5 select-none" style="top:50%; left:50%; transform:translate(-50%, -50%);">${d.tag}</div><h2 class="text-sm tracking-[0.5em] mb-4 opacity-60 uppercase">CHAPTER ${d.tag}</h2><h1 class="text-4xl font-bold tracking-widest font-title border-y-2 border-current py-6 px-4">${getTitle(d.title)}</h1><p class="mt-6 tracking-widest opacity-60">${parseLink(d.content).text}</p></div>`;break;
            case 'quote':inner+=`<div class="flex flex-col items-center justify-center h-full text-center px-8"><i class="fas fa-quote-left text-3xl opacity-20 mb-6"></i><h2 class="text-2xl font-serif leading-loose tracking-widest opacity-90 whitespace-pre-wrap font-title">${parseLink(d.content).text}</h2><div class="mt-8 w-full text-right font-bold opacity-60 text-sm"><span>â€” ${getTitle(d.title)}</span></div></div>`;break;
            case 'standard':inner+=`<div class="w-full h-full flex flex-col pt-16 px-8"><h2 class="text-3xl font-bold mb-10 tracking-widest font-title decoration-wavy underline decoration-current/30 underline-offset-8">${getTitle(d.title)}</h2><ul class="space-y-5 font-body">`+(d.list||[]).map(l=>`<li class="flex items-start"><span class="mr-3 mt-2 w-1.5 h-1.5 rounded-full bg-current opacity-60 flex-shrink-0"></span><span class="text-lg opacity-90 leading-relaxed">${parseLink(l).text}</span></li>`).join('')+`</ul></div>`;break;
            case 'numbered':inner+=`<div class="w-full h-full flex flex-col pt-14 px-6"><h2 class="text-2xl font-bold mb-8 tracking-widest font-title border-b border-current pb-2">${getTitle(d.title)}</h2><div class="space-y-6">`+(d.list||[]).map((l,i)=>`<div class="flex items-start gap-4"><div class="w-8 h-8 rounded-full border border-current flex items-center justify-center flex-shrink-0 font-serif font-bold opacity-80">${i+1}</div><div class="pt-1 text-lg opacity-90 font-body">${parseLink(l).text}</div></div>`).join('')+`</div></div>`;break;
            case 'checklist':inner+=`<div class="w-full h-full flex flex-col pt-16 px-8"><h2 class="text-2xl font-bold mb-8 tracking-widest font-title text-center bg-black/5 py-2 rounded">${getTitle(d.title)}</h2><div class="space-y-4">`+(d.list||[]).map(l=>`<div class="flex items-center gap-3 p-2 border-b border-current/20"><i class="far fa-check-square text-xl opacity-60"></i><span class="text-lg opacity-90">${parseLink(l).text}</span></div>`).join('')+`</div></div>`;break;
            case 'grid':inner+=`<div class="w-full h-full flex flex-col pt-16 px-4"><h2 class="text-2xl font-bold mb-8 tracking-widest opacity-90 text-center font-title">${getTitle(d.title)}</h2><div class="grid grid-cols-2 gap-4 w-full">`+(d.list||[]).map(l=>{const{text,url}=parseLink(l);return`<div class="grid-box h-24 flex items-center justify-center cursor-pointer hover:bg-black/5" onclick="${url?`window.open('${url}')`:''}"><span class="font-bold text-lg opacity-80 font-body">${text}</span></div>`}).join('')+`</div></div>`;break;
            case 'grid3':inner+=`<div class="w-full h-full flex flex-col pt-16 px-4"><h2 class="text-2xl font-bold mb-6 tracking-widest opacity-90 text-center font-title">${getTitle(d.title)}</h2><div class="grid grid-cols-2 gap-3 w-full">`+(d.list||[]).map(l=>`<div class="border border-current rounded p-3 text-center flex items-center justify-center aspect-[4/3]"><span class="font-bold opacity-80 leading-tight">${parseLink(l).text}</span></div>`).join('')+`</div></div>`;break;
            case 'stat':{const p=d.content.split('##');inner+=`<div class="w-full h-full flex flex-col items-center justify-center px-6"><h3 class="text-xl tracking-widest opacity-60 mb-6 uppercase">${getTitle(d.title)}</h3><div class="text-6xl font-bold font-serif mb-4 tracking-tighter">${p[0]}</div><div class="text-lg opacity-80 font-body bg-current text-white px-4 py-1 rounded-full" style="background-color: var(--text-color);">${p[1]||''}</div></div>`;break;}
            case 'keyvalue':inner+=`<div class="w-full h-full flex flex-col justify-center px-6"><h2 class="text-center text-2xl font-bold mb-10 tracking-widest opacity-90 font-title">${getTitle(d.title)}</h2><div class="space-y-4 w-full">`+(d.list||[]).map(l=>{const{text,url}=parseLink(l);return`<div class="key-value"><span class="text-lg font-medium opacity-80 w-full flex justify-between font-body">${text}<span class="font-bold">${url||''}</span></span></div>`}).join('')+`</div></div>`;break;
            case 'chart':{const mv=Math.max(...(d.list||[]).map(l=>parseFloat(l.split('##')[1])||0));inner+=`<div class="w-full h-full flex flex-col pt-16 px-6"><h2 class="text-2xl font-bold mb-8 tracking-widest text-center font-title">${getTitle(d.title)}</h2><div class="flex-1 flex flex-col justify-center">`+(d.list||[]).map(l=>{const p=l.split('##');return`<div class="bar-container"><div class="bar-label font-bold">${p[0]}</div><div class="bar-track"><div class="bar-fill" style="width: ${(parseFloat(p[1])||0)/mv*100}%"></div></div><div class="bar-value">${parseFloat(p[1])||0}</div></div>`}).join('')+`</div></div>`;break;}
            case 'comparison':inner+=`<div class="w-full h-full flex flex-col pt-14 px-4"><h2 class="text-2xl font-bold mb-6 tracking-widest text-center font-title">${getTitle(d.title)}</h2><div class="flex-1 border-t-2 border-b-2 border-current py-4 overflow-hidden"><div class="grid grid-cols-2 h-full divide-x divide-current/30"><div class="px-2 space-y-4 text-center"><div class="font-bold text-sm opacity-50 mb-2">ä¸€èˆ¬æ–¹æ¡ˆ</div>`+(d.list||[]).map(l=>`<div class="text-sm py-2 border-b border-dotted border-current/20 h-16 flex items-center justify-center">${parseLink(l.split('##')[0]).text}</div>`).join('')+`</div><div class="px-2 space-y-4 text-center"><div class="font-bold text-sm opacity-50 mb-2">æœ¬æ–¹æ¡ˆ</div>`+(d.list||[]).map(l=>`<div class="text-sm font-bold py-2 border-b border-dotted border-current/20 h-16 flex items-center justify-center">${parseLink(l.split('##')[1]||'').text}</div>`).join('')+`</div></div></div></div>`;break;
            case 'table':inner+=`<div class="w-full h-full flex flex-col pt-16 px-6"><h2 class="text-2xl font-bold mb-6 tracking-widest text-center font-title">${getTitle(d.title)}</h2><table class="w-full text-sm border-collapse"><thead><tr class="border-b-2 border-current"><th class="py-2 text-left w-1/2">é …ç›®</th><th class="py-2 text-right">å…§å®¹</th></tr></thead><tbody>`+(d.list||[]).map(l=>{const p=l.split('##');return`<tr class="border-b border-current/10"><td class="py-3 font-bold opacity-80">${parseLink(p[0]).text}</td><td class="py-3 text-right opacity-90">${parseLink(p[1]||'').text}</td></tr>`}).join('')+`</tbody></table></div>`;break;
            case 'timeline':inner+=`<div class="w-full h-full flex flex-col pt-14 px-8"><h2 class="text-2xl font-bold mb-8 tracking-widest opacity-90 border-b border-current pb-2 font-title">${getTitle(d.title)}</h2><div class="pl-2">`+(d.list||[]).map(l=>`<div class="timeline-item"><div class="font-bold text-lg opacity-90 font-body">${parseLink(l).text}</div></div>`).join('')+`</div></div>`;break;
            case 'process':inner+=`<div class="w-full h-full flex flex-col pt-16 px-6"><h2 class="text-2xl font-bold mb-10 tracking-widest text-center font-title">${getTitle(d.title)}</h2><div class="flex-1 flex flex-col gap-4">`+(d.list||[]).map((l,i)=>`<div class="flex items-center"><div class="w-full border border-current rounded p-3 text-center font-bold relative">${parseLink(l).text}${i<(d.list.length-1)?`<div class="absolute -bottom-5 left-1/2 -translate-x-1/2 text-current"><i class="fas fa-arrow-down"></i></div>`:''}</div></div>${i<(d.list.length-1)?`<div class="h-4"></div>`:''}`).join('')+`</div></div>`;break;
            case 'qa':inner+=`<div class="w-full h-full flex flex-col pt-14 px-6"><h2 class="text-2xl font-bold mb-6 tracking-widest text-center font-title decoration-4 underline decoration-current/20">${getTitle(d.title)}</h2><div class="space-y-6 overflow-y-auto">`+(d.list||[]).map(l=>{const p=l.split('##');return`<div><div class="font-bold text-lg mb-1 flex gap-2"><span class="opacity-50">Q.</span><span>${parseLink((p[0]||'').replace('Q:','').trim()).text}</span></div><div class="text-sm opacity-80 pl-6 border-l-2 border-current/30 ml-1 py-1">${parseLink((p[1]||'').replace('A:','').trim()).text}</div></div>`}).join('')+`</div></div>`;break;
            case 'warning':inner+=`<div class="w-full h-full flex flex-col justify-center px-6"><div class="border-2 border-current p-6 relative"><span class="absolute -top-3 left-4 bg-[#f9f6ea] px-2 font-bold tracking-widest text-sm opacity-80 font-title" style="background-color: var(--card-bg);">${getTitle(d.title)}</span><ul class="list-disc pl-5 space-y-3 opacity-80 font-medium font-body text-sm leading-relaxed">`+(d.list||[]).map(l=>`<li>${parseLink(l).text}</li>`).join('')+`</ul></div></div>`;break;
            case 'contact':{const{text,url}=parseLink(d.content);inner+=`<div class="w-full h-full flex flex-col items-center justify-center px-6 text-center"><div class="w-20 h-20 rounded-full border-2 border-current flex items-center justify-center mb-6 text-3xl opacity-80"><i class="fas fa-user"></i></div><h2 class="text-2xl font-bold mb-6 tracking-widest font-title">${getTitle(d.title)}</h2><p class="text-lg opacity-80 whitespace-pre-wrap leading-loose font-body">${url?`<a href="${url}" target="_blank" class="text-link">${text}</a>`:text}</p></div>`;break;}
        }
        inner+=`</div>`;card.innerHTML=inner;card.style.touchAction="none";
        if(i===viewingStartIndex){card.style.display='flex';card.style.transform='scale(1)';card.style.opacity=1;card.style.zIndex=100;card.style.pointerEvents='auto';}else if(i>viewingStartIndex&&i-viewingStartIndex===1){card.style.display='flex';card.style.transform='scale(0.98)';card.style.opacity=0.5;card.style.zIndex=99;card.style.pointerEvents='none';}else{card.style.display='none';}c.appendChild(card);});
        
        initStackInteraction(); 
        
        // â˜… æ ¸å¿ƒé‚è¼¯ï¼šåªåœ¨é‡è¦è²æ˜é é¢é¡¯ç¤ºé½’è¼ª
        const ab=document.getElementById('admin-btn');
        if(cardsData[viewingStartIndex]&&(cardsData[viewingStartIndex].type==='warning'||cardsData[viewingStartIndex].title.includes('é‡è¦è²æ˜'))) ab.style.display='flex';
        else ab.style.display='none';
        }
        
        function initStackInteraction(){
            const stack = document.getElementById('card-stack');
            if(stack._handleDown) stack.removeEventListener('pointerdown', stack._handleDown);

            let isDragging = false, startX = 0, currentX = 0, activeCard = null;

            const handleDown = (e) => {
                if(e.target.closest('a') || e.target.closest('button') || e.target.closest('.cursor-pointer')) return;
                
                const allCards = document.querySelectorAll('.card');
                if(!allCards[viewingStartIndex]) return;
                
                activeCard = allCards[viewingStartIndex];

                if(!activeCard.contains(e.target)) return;

                isDragging = true;
                startX = e.clientX;
                activeCard.style.transition = 'none';
                try{ activeCard.setPointerCapture(e.pointerId); } catch(err){}
                
                document.addEventListener('pointermove', handleMove);
                document.addEventListener('pointerup', handleUp);
                document.addEventListener('pointercancel', handleUp);
            };

            const handleMove = (e) => {
                if(!isDragging || !activeCard) return;
                e.preventDefault(); 
                
                const tx = (e.clientX - startX) / currentScaleFactor;
                
                if(viewingStartIndex === 0 && tx > 50) return;
                if(viewingStartIndex === cardsData.length - 1 && tx < -50) return;
                
                currentX = tx;
                if(Math.abs(currentX) > 0) {
                    activeCard.style.transform = `translateX(${currentX}px) rotate(${currentX * 0.05}deg)`;
                }
            };

            const handleUp = (e) => {
                if(!isDragging || !activeCard) return;
                isDragging = false;
                
                document.removeEventListener('pointermove', handleMove);
                document.removeEventListener('pointerup', handleUp);
                document.removeEventListener('pointercancel', handleUp);
                
                activeCard.style.transition = 'transform 0.6s cubic-bezier(0.2, 0.8, 0.2, 1)';
                
                if(Math.abs(currentX) > 80) {
                    const dir = currentX > 0 ? 1 : -1; 
                    activeCard.style.transform = `translateX(${dir === 1 ? 1200 : -1200}px) rotate(${dir * 15}deg)`;
                    setTimeout(() => changePage(dir), 200);
                } else {
                    activeCard.style.transform = 'translate(0,0)';
                }
                currentX = 0;
                activeCard = null;
            };

            stack._handleDown = handleDown;
            stack.addEventListener('pointerdown', handleDown);
        }
        
        window.changePage=d=>{const n=viewingStartIndex-d;if(n<0||n>=cardsData.length)return;viewingStartIndex=n;renderCards();};
        window.jumpToCard=id=>{const i=cardsData.findIndex(c=>c.id===id);if(i!==-1){viewingStartIndex=i;renderCards();}};
        window.jumpToTOC=()=>{const t=cardsData.find(c=>c.type==='total_toc');if(t)jumpToCard(t.id);};
        function initAdminUI(){
            document.getElementById('global-paper-color').addEventListener('input',e=>{styleConfig.paperColor=e.target.value;applyStyles();});
            
            // â˜… ä¿®æ”¹ï¼šæ”¹ç‚º SHA-256 é©—è­‰
            document.getElementById('admin-btn').onclick = async () => {
                if(isVIP){
                    openAdmin();
                } else {
                    const input = prompt("è«‹è¼¸å…¥ç®¡ç†å“¡å¯†ç¢¼:");
                    if(input !== null) {
                        try {
                            const enc = new TextEncoder();
                            const buf = await window.crypto.subtle.digest("SHA-256", enc.encode(input));
                            const hex = [...new Uint8Array(buf)].map(x => x.toString(16).padStart(2,'0')).join('');
                            if (hex === _a_h) {
                                isVIP = true;
                                alert("é©—è­‰æˆåŠŸï¼");
                                openAdmin();
                            } else {
                                alert("å¯†ç¢¼éŒ¯èª¤ï¼Œæ‹’çµ•å­˜å–ï¼");
                            }
                        } catch(e) {
                            console.error(e);
                            alert("é©—è­‰éŒ¯èª¤");
                        }
                    }
                }
            };
            
            document.getElementById('close-admin-btn').onclick=()=>{document.getElementById('admin-panel').style.display='none';adjustLayout();};
            document.getElementById('add-page-btn').onclick=()=>{cardsData.push({id:'c_'+Date.now(),type:'standard',title:'æ–°é é¢',tag:'NEW',list:['å…§å®¹...']});updateMemoryState();};
            document.getElementById('reset-data-btn').onclick=()=>{if(confirm('é‡ç½®?'))location.reload();};
            document.getElementById('delete-page-btn').onclick=()=>{if(confirm('åˆªé™¤?')){cardsData=cardsData.filter(c=>c.id!==currentEditId);viewingStartIndex=Math.max(0,viewingStartIndex-1);updateMemoryState();showEditor(false);}};
            document.getElementById('apply-change-btn').onclick=applyEdit;
            document.getElementById('edit-title-scale').addEventListener('change',function(){if(this.value==='custom'){const v=prompt("æ¯”ä¾‹?");if(v){this.add(new Option(v+'%',v),this.lastChild);this.value=v;}applyEdit();}});
            document.getElementById('print-file-btn').onclick=()=>document.getElementById('print-settings-modal').classList.remove('hidden');
            window.closePrintModal=()=>document.getElementById('print-settings-modal').classList.add('hidden');
            window.executePrint=()=>{window.print();closePrintModal();};
            document.getElementById('save-file-btn').onclick=()=>{alert("âš ï¸ å®‰å…¨æç¤ºï¼šæ­¤ç‚ºæœ€çµ‚äº¤ä»˜ç‰ˆï¼Œåƒ…ä¾›ç€è¦½ã€‚å¦‚éœ€ä¿®æ”¹ï¼Œè«‹ä½¿ç”¨åŸå§‹ç·¨è¼¯å™¨ã€‚");};

            // â˜… æ–°å¢ï¼šåŒ¯å‡º JSON åŠŸèƒ½
            document.getElementById('export-json-btn').onclick = () => {
                // 1. åŒæ­¥ç•¶å‰ç·¨è¼¯ç‹€æ…‹åˆ°å…¨åŸŸç‰©ä»¶
                if(!window.bakedData) return;
                window.bakedData.cards = cardsData;
                window.bakedData.style = styleConfig;
                window.bakedData.library = textLibrary;
                
                // 2. è½‰æˆ Blob
                const str = JSON.stringify(window.bakedData, null, 2);
                const blob = new Blob([str], {type: "application/json"});
                const url = URL.createObjectURL(blob);
                
                // 3. ä¸‹è¼‰
                const a = document.createElement('a');
                a.href = url;
                let fName = "data_export.json";
                if(window.bakedData.clientInfo) {
                    fName = `data_${window.bakedData.clientInfo.name}_${window.bakedData.clientInfo.id}.json`;
                }
                a.download = fName;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            };
        }
        function openAdmin(){document.getElementById('admin-panel').style.display='flex';renderSidebar();adjustLayout();showEditor(false);}
        function renderSidebar(){const l=document.getElementById('page-list-container');l.innerHTML='';cardsData.forEach((c,i)=>{const d=document.createElement('div');d.className=`admin-card-item ${c.id===currentEditId?'active':''}`;d.onclick=()=>selectCard(c.id);d.innerHTML=`<span class="bg-gray-200 text-xs w-6 h-6 flex items-center justify-center rounded-full mr-2">${i+1}</span><div class="truncate text-sm font-bold text-gray-700 flex-1">${c.title}</div>`;l.appendChild(d);});}
        function selectCard(id){currentEditId=id;renderSidebar();const c=cardsData.find(x=>x.id===id);if(!c)return;document.getElementById('edit-type').value=c.type;document.getElementById('edit-title').value=c.title;document.getElementById('edit-tag').value=c.tag||'';document.getElementById('edit-color').value=c.color||'#594a42';if(['cover','intro','chapter','quote','stat','contact'].includes(c.type))document.getElementById('edit-content').value=c.content||'';else document.getElementById('edit-content').value=(c.list||[]).join('\n');showEditor(true);jumpToCard(id);}
        function showEditor(s){document.getElementById('editor-form').className=s?'w-full bg-white p-6 rounded-xl shadow-sm border border-gray-200':'hidden';document.getElementById('editor-empty').className=s?'hidden':'h-full flex flex-col items-center justify-center text-gray-400';}
        function applyEdit(){const c=cardsData.find(x=>x.id===currentEditId);if(!c)return;c.type=document.getElementById('edit-type').value;c.title=document.getElementById('edit-title').value;c.tag=document.getElementById('edit-tag').value;c.color=document.getElementById('edit-color').value;c.titleScale=document.getElementById('edit-title-scale').value;const v=document.getElementById('edit-content').value;if(['cover','intro','chapter','quote','stat','contact'].includes(c.type)){c.content=v;delete c.list;}else{c.list=v.split('\n');delete c.content;}updateMemoryState();alert('å·²ä¿®æ”¹ (æš«å­˜)');}
        function renderLibraryList(){const d=document.getElementById('lib-list-container');d.innerHTML='';textLibrary.forEach((t,i)=>{const b=document.createElement('div');b.className='lib-item '+(i===selectedLibIndex?'active':'');b.innerText=t.content;b.onclick=()=>{selectedLibIndex=i;renderLibraryList();};d.appendChild(b);});}
        function lib_add_new(){const v=document.getElementById('lib-new-content').value;if(v){textLibrary.push({content:v});renderLibraryList();}}
        function lib_insert_at_cursor(){if(selectedLibIndex<0)return;const t=textLibrary[selectedLibIndex].content;const e=document.getElementById('edit-content');e.setRangeText(t,e.selectionStart,e.selectionEnd,'end');}
        function lib_delete(){if(selectedLibIndex>=0){textLibrary.splice(selectedLibIndex,1);selectedLibIndex=-1;renderLibraryList();}}
        window.insertLink=()=>{const u=prompt('URL?');if(u)document.getElementById('edit-content').setRangeText(`[link:${u}]é€£çµæ–‡å­—[/link]`);};
        window.insertColorCode=(c)=>document.getElementById('edit-content').setRangeText(`[color:${c}]æ–‡å­—[/color]`);
        
    </script>
</body>
</html>