<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä¿å–®è³‡ç”¢ç®¡ç† - A03764</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=LXGW+WenKai+TC:wght@300;400;700&family=Noto+Sans+TC:wght@300;400;700&family=Noto+Serif+TC:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style id="print-dynamic-style"></style>
    <style id="main-style">
        :root{--bg-color:#f3f4f6;--card-bg:#f9f6ea;--text-primary:#594a42;--font-title:'Noto Serif TC',serif;--font-body:'Noto Sans TC',sans-serif}body{background-color:var(--bg-color);background-image:radial-gradient(#e5e7eb 1px,transparent 1px);background-size:20px 20px;font-family:var(--font-body);color:var(--text-primary);overflow:hidden;position:fixed;width:100%;height:100%;touch-action:none;-webkit-user-select:none;user-select:none;overscroll-behavior:none}.font-title{font-family:var(--font-title)}.font-body{font-family:var(--font-body)}#toast-notification{position:fixed;bottom:80px;left:50%;transform:translateX(-50%) translateY(20px);background-color:rgba(45,42,38,.85);color:#fff;padding:10px 24px;border-radius:50px;font-size:.9rem;font-weight:500;opacity:0;pointer-events:none;transition:all .3s cubic-bezier(.2,.8,.2,1);z-index:2500;box-shadow:0 4px 15px rgba(0,0,0,0.15);backdrop-filter:blur(4px);font-family:'Noto Sans TC',sans-serif;letter-spacing:.05em}#toast-notification.show{opacity:1;transform:translateX(-50%) translateY(0)}.card-page-num{position:absolute;bottom:15px;right:20px;font-size:.9rem;font-weight:700;color:var(--text-primary);opacity:.4;font-family:'Noto Sans TC',monospace;z-index:50;pointer-events:none}#admin-btn{position:fixed;bottom:20px;right:20px;width:56px;height:56px;background:#2d2a26;border:3px solid #fff;border-radius:50%;display:none;align-items:center;justify-content:center;color:#fff;z-index:1000;cursor:pointer;box-shadow:0 4px 15px rgba(0,0,0,0.4);transition:all .3s}#admin-btn:hover{transform:scale(1.1);background:#4a453f}#admin-panel{position:fixed;top:0;left:0;width:100%;height:100%;background:0 0;z-index:2000;display:none;flex-direction:column;overflow:hidden;pointer-events:none}#admin-panel>*{pointer-events:auto}.admin-layout-container{pointer-events:none}.admin-editor,.admin-header,.admin-sidebar{pointer-events:auto}.admin-header{background:#fff;border-bottom:1px solid #e5e7eb;box-shadow:0 2px 10px rgba(0,0,0,0.05)}.admin-sidebar{background:#fff;border-right:1px solid #e5e7eb;overflow-y:auto;display:flex;flex-direction:column}.admin-editor{background:#f8f9fa;overflow-y:auto}.admin-card-item{padding:1rem;border-bottom:1px solid #f3f4f6;cursor:pointer;transition:background .2s;display:flex;justify-content:space-between;align-items:center}.admin-card-item:hover{background:#f9fafb}.admin-card-item.active{background:#eff6ff;border-left:4px solid #3b82f6}.form-label{display:block;font-size:.875rem;font-weight:500;color:#374151;margin-bottom:.25rem}.form-input{width:100%;padding:.5rem;border:1px solid #d1d5db;border-radius:.375rem;margin-bottom:1rem;font-family:'Noto Sans TC',sans-serif}.form-input:focus{outline:0;border-color:#3b82f6;ring:2px solid #93c5fd}.global-settings{background:#fff;border-bottom:1px solid #e5e7eb;padding:1rem;flex-shrink:0}.library-container{border:2px solid #e2e8f0;border-radius:8px;background:#fff;overflow:hidden;margin-bottom:24px}.lib-section-title{background:#f1f5f9;padding:8px 12px;font-size:.75rem;font-weight:700;color:#64748b;text-transform:uppercase;letter-spacing:.05em;border-bottom:1px solid #e2e8f0;display:flex;justify-content:space-between;align-items:center}.lib-area{padding:12px}.lib-area+.lib-section-title{border-top:1px solid #e2e8f0}.lib-item{padding:8px;border-bottom:1px solid #f1f5f9;font-size:.875rem;color:#4b5563;cursor:pointer;transition:all .2s;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.lib-item:hover{background-color:#f8fafc}.lib-item.active{background-color:#e0e7ff;color:#4338ca;font-weight:700;border-left:3px solid #4338ca}#card-stack{position:fixed;width:375px;height:660px;left:50%;top:50%;transform:translate(-50%,-50%);margin:0;z-index:100;transition:all .5s cubic-bezier(.2,.8,.2,1);touch-action:none;-webkit-user-select:none;user-select:none;will-change:transform}.card{position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--card-bg);box-shadow:0 4px 20px rgba(0,0,0,0.1);border:1px solid rgba(0,0,0,0.05);border-radius:12px;padding:2rem;display:flex;flex-direction:column;justify-content:center;align-items:center;cursor:grab;user-select:none;will-change:transform;transform-origin:50% 100%;overflow:hidden;touch-action:none;display:none}.card:active{cursor:grabbing}.card-sheen{position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(115deg,transparent 0,rgba(255,255,255,.4) 45%,rgba(255,255,255,0) 55%,transparent 100%);pointer-events:none;z-index:10;opacity:0;transition:opacity .5s ease-out;mix-blend-mode:screen}.card-content{position:relative;z-index:5;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;pointer-events:none}.back-btn{position:absolute;top:10px;left:10px;font-size:.7rem;font-family:'Noto Sans TC',sans-serif;font-weight:700;color:gray;background:rgba(255,255,255,.5);padding:2px 6px;border-radius:4px;cursor:pointer;z-index:50;text-transform:uppercase;letter-spacing:.05em;transition:all .2s;border:1px solid transparent;pointer-events:auto}.back-btn:hover{color:#333;background:rgba(255,255,255,.9);border-color:#ddd}a{pointer-events:auto}a.text-link{text-decoration:underline;text-decoration-style:dotted;text-underline-offset:4px;transition:all .2s}a.text-link:hover{opacity:.7}span[style*="color"]{display:inline}a[href]{cursor:pointer}.timeline-item{position:relative;padding-left:20px;border-left:2px solid currentColor;padding-bottom:20px}.timeline-item::before{content:'';position:absolute;left:-6px;top:5px;width:10px;height:10px;background:currentColor;border-radius:50%}.timeline-item:last-child{border-left:none}.grid-box{border:1px solid currentColor;padding:10px;border-radius:4px;text-align:center;pointer-events:auto}.key-value{display:flex;justify-content:space-between;border-bottom:1px dashed currentColor;padding:8px 0;width:100%}.bar-container{width:100%;display:flex;align-items:center;margin-bottom:8px;font-size:.8rem}.bar-label{width:30%;text-align:right;padding-right:10px;opacity:.8}.bar-track{flex:1;height:8px;background:rgba(0,0,0,0.05);border-radius:4px;overflow:hidden}.bar-fill{height:100%;background:currentColor;opacity:.7;border-radius:4px}.bar-value{width:15%;padding-left:8px;font-size:.7rem;opacity:.6}.custom-scrollbar{pointer-events:auto}.custom-scrollbar::-webkit-scrollbar{width:4px}.custom-scrollbar::-webkit-scrollbar-track{background:0 0}.custom-scrollbar::-webkit-scrollbar-thumb{background:rgba(0,0,0,0.1);border-radius:2px}.custom-scrollbar::-webkit-scrollbar-thumb:hover{background:rgba(0,0,0,0.2)}@media print{body{-webkit-print-color-adjust:exact;print-color-adjust:exact;background:#fff!important;background-image:none!important;overflow:visible!important;height:auto!important;position:relative!important;zoom:1!important}#add-page-btn,#admin-btn,#admin-panel,#close-admin-btn,#print-file-btn,#print-settings-modal,#save-file-btn,#export-json-btn,#start-overlay,#toast-notification,.back-btn,.card-sheen{display:none!important}#card-stack{position:static!important;width:100%!important;max-width:100%!important;height:auto!important;transform:none!important;display:grid!important;gap:20px;margin:0!important;padding:20px;top:auto!important;left:auto!important}.card{position:relative!important;width:100%!important;height:480px!important;top:auto!important;left:auto!important;transform:none!important;box-shadow:none!important;border:1px solid #ddd!important;page-break-inside:avoid;break-inside:avoid;margin-bottom:20px;background-color:var(--card-bg)!important;display:flex!important}.card-content{zoom:.9}a{text-decoration:none!important;color:inherit!important;pointer-events:none}}#password-section{opacity:0;transform:scale(.1) translateZ(-1000px);transition:all 2s cubic-bezier(.19,1,.22,1);display:none;pointer-events:none}#password-section.active{display:flex;opacity:1;transform:scale(1) translateZ(0);pointer-events:auto}#lock-message{display:none;flex-direction:column;align-items:center;gap:1rem;margin-top:2rem;animation:fadeIn .5s ease-in}#lock-text{cursor:default}@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}#trigger-btn{transition:opacity .5s}#access-input{letter-spacing:.1em;text-align:center}#access-input::placeholder{font-size:.8rem;letter-spacing:0;color:#a8a29e}
        
        /* â˜… ç´…æ¡†è™•ï¼šå®¢æˆ¶ç·¨è™Ÿ (ç”± JS å‹•æ…‹å¡«å…¥) */
        #client-id-display {
            margin-top: 15px;
            font-family: 'Noto Sans TC', monospace;
            font-size: 0.85rem;
            color: #a8a29e;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            font-weight: bold;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-start h-screen w-screen overflow-hidden relative">
    <button id="admin-btn" title="é€²å…¥å¾Œå°ç·¨è¼¯"><i class="fas fa-cog text-2xl"></i></button>
    <div id="toast-notification">å·²ç¶“æ˜¯ç¬¬ä¸€é å›‰ï¼</div>
    
    <div id="print-settings-modal" class="fixed inset-0 bg-black/60 z-[3000] hidden flex items-center justify-center backdrop-blur-sm"><div class="bg-white rounded-lg shadow-2xl w-full max-w-[340px] overflow-hidden"><div class="bg-gray-800 text-white px-4 py-3 flex justify-between items-center"><h3 class="text-base font-bold flex items-center gap-2"><i class="fas fa-print"></i> åˆ—å° / PDF è¨­å®š</h3><button onclick="closePrintModal()" class="text-gray-400 hover:text-white transition"><i class="fas fa-times"></i></button></div><div class="p-4 space-y-4"><div><label class="block text-xs font-bold text-gray-500 mb-2 uppercase tracking-wide">1. æª”æ¡ˆå„ªåŒ–</label><div class="grid grid-cols-2 gap-2"><label class="cursor-pointer border border-gray-200 rounded p-2 hover:border-blue-500 hover:bg-blue-50 transition flex flex-col items-center gap-1 group has-[:checked]:border-blue-600 has-[:checked]:bg-blue-50"><input type="radio" name="print_mode" value="original" class="hidden" checked=""><i class="fas fa-palette text-lg text-gray-400 group-has-[:checked]:text-blue-600"></i><span class="text-xs font-bold text-gray-700">ä¿æŒåŸæ¨£</span></label><label class="cursor-pointer border border-gray-200 rounded p-2 hover:border-red-600 hover:bg-red-600 transition flex flex-col items-center gap-1 group has-[:checked]:border-green-600 has-[:checked]:bg-green-50"><input type="radio" name="print_mode" value="compress" class="hidden"><i class="fas fa-font text-lg text-gray-400 group-hover:text-white group-has-[:checked]:text-green-600"></i><span class="text-xs font-bold text-gray-700 group-hover:text-white">è®Šæ›´å­—é«”</span></label></div></div><div><label class="block text-xs font-bold text-gray-500 mb-1 uppercase tracking-wide">2. æ’åˆ—æ–¹å¼</label><select id="print-layout" class="w-full border border-gray-300 rounded p-2 text-sm bg-white"><option value="2" selected="">ç›´å¼æ’åˆ— (2å¼µ/é )</option><option value="4">ç”°å­—æ’åˆ— (4å¼µ/é )</option></select></div></div><div class="p-3 border-t bg-gray-50 flex justify-end gap-2"><button onclick="closePrintModal()" class="px-3 py-1.5 text-gray-500 hover:bg-gray-200 rounded text-xs font-medium transition">å–æ¶ˆ</button><button onclick="executePrint()" class="px-4 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded text-xs font-bold shadow transition flex items-center gap-1"><i class="fas fa-print"></i> åˆ—å°</button></div></div></div>
    
    <div id="admin-panel" class="flex flex-row" style="display: none;"><div class="admin-header w-full h-16 flex justify-between items-center px-6 fixed top-0 left-0 z-50"><h2 class="text-xl font-bold text-gray-800 flex items-center gap-2"><i class="fas fa-edit text-blue-500"></i> 20æ¬¾ç‰ˆé¢ç·¨è¼¯å™¨</h2><div class="flex gap-3"><button id="print-file-btn" class="bg-emerald-600 text-white px-4 py-2 rounded hover:bg-emerald-700 transition shadow-sm text-sm font-bold flex items-center"><i class="fas fa-print mr-2"></i> åˆ—å°è¨­å®š</button><div class="w-[1px] h-8 bg-gray-300 mx-2"></div><button id="save-file-btn" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition shadow-sm text-sm font-bold flex items-center"><i class="fas fa-save mr-2"></i> å„²å­˜ä¸¦ä¸‹è¼‰æ–°æª”</button><div class="w-[1px] h-8 bg-gray-300 mx-2"></div><button id="export-json-btn" class="bg-amber-600 text-white px-4 py-2 rounded hover:bg-amber-700 transition shadow-sm text-sm font-bold flex items-center"><i class="fas fa-file-export mr-2"></i> åŒ¯å‡º JSON</button><div class="w-[1px] h-8 bg-gray-300 mx-2"></div><button id="add-page-btn" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition shadow-sm text-sm"><i class="fas fa-plus mr-1"></i> æ–°å¢é é¢</button><button id="close-admin-btn" class="bg-gray-800 text-white px-4 py-2 rounded hover:bg-black transition shadow-sm text-sm">é—œé–‰</button></div></div><div class="admin-layout-container flex w-full h-full pt-16"><div class="w-[35%] h-full hidden md:block"></div><div class="admin-sidebar w-full md:w-[25%] h-full flex flex-col bg-white border-r border-gray-200 shadow-sm relative z-10"><div class="global-settings"><h4 class="text-xs font-bold text-gray-500 uppercase mb-3">ğŸ¨ å…¨å±€é¢¨æ ¼è¨­å®š</h4><div class="grid grid-cols-2 gap-2 mb-2"><div><label class="text-xs text-gray-400 block mb-1">ç´™å¼µé¡è‰²</label><input type="color" id="global-paper-color" class="w-full h-8 p-0 border rounded cursor-pointer" value="#f9f6ea"></div></div></div><div class="p-4 bg-gray-50 border-b text-xs font-bold text-gray-400 uppercase tracking-wider flex-shrink-0">é é¢åˆ—è¡¨</div><div id="page-list-container" class="flex-1 overflow-y-auto custom-scrollbar"></div><div class="p-4 border-t flex-shrink-0"><button id="reset-data-btn" class="text-red-400 hover:text-red-600 text-xs underline w-full text-center">æ¢å¾©åŸå§‹ç¯„ä¾‹</button></div></div><div class="admin-editor flex-1 h-full p-8 overflow-y-auto border-l border-gray-100 bg-[#f8f9fa]"><div id="editor-empty" class="h-full flex flex-col items-center justify-center text-gray-400"><i class="fas fa-arrow-left text-4xl mb-4"></i><p>è«‹é»é¸å·¦å´é é¢é–‹å§‹ç·¨è¼¯</p></div><div id="editor-form" class="hidden w-full bg-white p-6 rounded-xl shadow-sm border border-gray-200"><div class="flex justify-between items-center mb-6 pb-4 border-b"><h3 class="text-lg font-bold text-gray-800">ç·¨è¼¯é é¢å…§å®¹</h3><span id="editing-id-display" class="text-xs text-gray-400 font-mono"></span></div><div class="grid grid-cols-2 gap-6"><div><label class="form-label">ç‰ˆå‹é¸æ“‡</label><select id="edit-type" class="form-input bg-gray-50 font-bold text-gray-700 text-sm"><optgroup label="åŠŸèƒ½é é¢"><option value="total_toc">â˜… è‡ªå‹•ç¸½ç›®éŒ„ (Auto TOC)</option><option value="cover">1. å°é¢ (Cover)</option><option value="intro">2. å‰è¨€/æ•˜è¿° (Intro)</option><option value="toc">3. æ‰‹å‹•ç›®éŒ„ (Manual Index)</option><option value="chapter">4. ç« ç¯€é  (Chapter)</option><option value="quote">5. é‡‘å¥ (Quote)</option></optgroup><optgroup label="æ¸…å–®èˆ‡æ¢åˆ—"><option value="standard">6. é …ç›®æ¸…å–® (Bullets)</option><option value="numbered">7. æ•¸å­—æ¸…å–® (1.2.3)</option><option value="checklist">8. æª¢æŸ¥è¡¨ (Checklist)</option><option value="grid">9. ç¶²æ ¼åœ–æ¨™ (Grid 4)</option><option value="grid3">10. ç¶²æ ¼åœ–æ¨™ (Grid 3)</option></optgroup><optgroup label="è³‡è¨Šåœ–è¡¨"><option value="stat">11. é—œéµæ•¸å­— (Big Stat)</option><option value="keyvalue">12. è¦æ ¼æ•¸å€¼ (Specs)</option><option value="chart">13. ç°¡æ˜“é•·æ¢åœ– (Chart)</option><option value="comparison">14. å°ç…§æ¯”è¼ƒ (VS)</option><option value="table">15. è¡¨æ ¼ (Table)</option></optgroup><optgroup label="æµç¨‹èˆ‡å…¶ä»–"><option value="timeline">16. å‚ç›´æ™‚é–“è»¸ (Timeline)</option><option value="process">17. æ©«å‘æµç¨‹ (Process)</option><option value="qa">18. å•èˆ‡ç­” (Q&A)</option><option value="warning">19. è­¦èª/æ³¨æ„ (Warning)</option><option value="contact">20. åç‰‡/çµå°¾ (Contact)</option></optgroup></select></div><div><label class="form-label">ä¸»é¡Œè‰²ç³»</label><div class="flex items-center gap-2"><input type="color" id="edit-color" class="h-[42px] w-[60px] cursor-pointer border rounded p-1"><span class="text-xs text-gray-400">é»æ“Šæ›´æ›æ–‡å­—èˆ‡è£é£¾é¡è‰²</span></div></div></div><div class="grid grid-cols-3 gap-6"><div class="col-span-2"><label class="form-label">ä¸»æ¨™é¡Œ</label><input type="text" id="edit-title" class="form-input font-bold mb-2" placeholder="è¼¸å…¥æ¨™é¡Œå…§å®¹..."><div class="flex items-center gap-2"><label class="text-xs text-gray-500">ç¸®æ”¾æ¯”ä¾‹ï¼š</label><select id="edit-title-scale" class="form-input w-32 mb-0 text-sm bg-gray-50 cursor-pointer font-mono text-center p-1 h-8 py-0"><option value="70">70%</option><option value="80">80%</option><option value="90">90%</option><option value="100">100%</option><option value="110">110%</option><option value="120">120%</option><option value="custom">è‡ªè¨‚ %...</option></select></div></div><div><label class="form-label">å´é‚Šæ¨™ç±¤/å°æ¨™</label><input type="text" id="edit-tag" class="form-input"></div></div><div class="library-container"><div class="lib-section-title text-green-700 bg-green-50 border-green-200 flex justify-between items-center"><span><i class="fas fa-plus-circle mr-1"></i> æ–°å¢è³‡æ–™åˆ°é¡Œåº«</span><button onclick="lib_add_new()" class="bg-green-600 text-white px-3 py-1 rounded text-xs font-bold shadow hover:bg-green-700 whitespace-nowrap"><i class="fas fa-save"></i> å­˜å…¥</button></div><div class="lib-area bg-green-50/30"><div class="flex flex-col gap-2"><div class="relative"><textarea id="lib-new-content" placeholder="è«‹åœ¨æ­¤è¼¸å…¥æˆ–è²¼ä¸Šæ–‡å­— (é‡è¤‡å…§å®¹å°‡è¢«æ‹’çµ•)..." class="w-full h-16 text-sm border border-gray-300 rounded p-2 focus:outline-none focus:border-green-500 resize-none font-mono"></textarea></div></div></div><div class="lib-section-title text-indigo-700 bg-indigo-50 border-indigo-200"><span><i class="fas fa-list-ul mr-1"></i> é¡Œåº«åˆ—è¡¨ (é»é¸ä»¥åç™½)</span></div><div class="lib-area bg-indigo-50/30"><div id="lib-list-container" class="bg-white border border-gray-300 rounded overflow-y-auto custom-scrollbar mb-2" style="height: 160px;"></div><div class="flex gap-2"><button onclick="lib_insert_at_cursor()" class="flex-1 bg-indigo-600 text-white px-3 py-2 rounded text-sm font-bold shadow hover:bg-indigo-700 transition flex items-center justify-center gap-2"><i class="fas fa-mouse-pointer"></i> æ’å…¥æ–‡å­—</button><button onclick="lib_delete()" class="flex-1 bg-white text-red-500 hover:bg-red-50 px-3 py-2 rounded border border-red-200 text-sm font-bold shadow-sm transition flex items-center justify-center gap-2" title="åˆªé™¤é¸ä¸­çš„é¡Œåº«"><i class="fas fa-trash-alt"></i> åˆªé™¤</button></div></div></div><label class="form-label flex justify-between items-end"><div>å…§å®¹ç·¨è¼¯ <span class="text-xs text-orange-500 ml-2">(èªæ³•ï¼šæ–‡å­—## é€£çµ | [link:..] | [color:..])</span></div><div class="flex items-center gap-2 bg-gray-100 px-2 py-1 rounded border border-gray-200"><button onclick="insertLink()" class="text-gray-600 hover:text-blue-600 hover:bg-white p-1 rounded transition" title="æ’å…¥è¶…é€£çµ"><i class="fas fa-link"></i></button><div class="w-[1px] h-4 bg-gray-300"></div><label class="flex items-center gap-1 cursor-pointer text-gray-600 hover:text-gray-900"><i class="fas fa-palette text-sm"></i><input type="color" id="text-color-picker" class="w-5 h-5 p-0 border-0 bg-transparent cursor-pointer" value="#000000" onchange="insertColorCode(this.value)"></label></div></label><div id="hint-text" class="text-xs font-normal text-gray-500 mt-1 bg-yellow-50 p-2 rounded border border-yellow-100 mb-2">æç¤ºå€</div><textarea id="edit-content" class="form-input h-48 font-mono text-sm leading-relaxed"></textarea><div class="flex justify-end pt-4 border-t mt-4 gap-3"><button id="delete-page-btn" class="px-4 py-2 text-red-500 hover:bg-red-50 rounded transition text-sm">åˆªé™¤æ­¤é </button><button id="apply-change-btn" class="px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition shadow">ç¢ºèªä¿®æ”¹ (æš«å­˜)</button></div></div></div></div></div>

    <div id="start-overlay" class="fixed top-0 left-0 w-full h-full bg-[#fdfcf8] z-[1500] flex flex-col justify-center items-center transition-opacity duration-500" style="opacity: 1; display: flex;"><div class="text-center p-8 border-y border-stone-200"><h1 class="text-4xl font-bold text-stone-700 mb-2 tracking-widest font-title">ä¿å–®è³‡ç”¢ç®¡ç†</h1><p class="text-sm text-stone-400 tracking-[0.5em] font-body">20 STYLES COLLECTION</p></div><button id="trigger-btn" onclick="startPasswordAnimation()" class="mt-12 px-12 py-3 border border-stone-600 text-stone-600 hover:bg-stone-600 hover:text-white transition-all rounded-sm tracking-widest font-body">é–‹å§‹ç¿»é–±</button>
        
        <div id="client-id-display">Client ID: A03764</div>

        <div id="password-section" class="mt-8 flex flex-col items-center gap-4 w-full max-w-[280px]"><div class="relative w-full"><input type="password" id="access-input" placeholder="è«‹è¼¸å…¥å¯†ç¢¼" class="w-full px-4 py-3 border border-stone-300 rounded bg-[#fdfcf8] focus:border-stone-500 focus:ring-1 focus:ring-stone-500 outline-none transition text-stone-700 placeholder-stone-400"></div><button id="submit-pass-btn" onclick="checkPassword()" class="w-full px-8 py-3 bg-stone-700 text-white hover:bg-stone-900 transition-all rounded-sm tracking-widest font-body">ç¢ºèªé€²å…¥</button><p id="error-msg" class="text-red-500 text-xs tracking-wider opacity-0 transition-opacity">å¯†ç¢¼éŒ¯èª¤</p></div><div id="lock-message"><p id="lock-text" class="text-red-600 text-xl font-bold tracking-widest cursor-pointer select-none">éŒ¯èª¤å·²é”3æ¬¡ï¼Œæª”æ¡ˆé–ä½!</p></div></div>
    <div id="card-stack"></div>

    <script id="main-script">
        const _p_h = "6d9d42616fda82088254176d81898f0c807cee4f008c1a90ef07d20199e45177";
        const _a_h = "80ce719a659f90e18789655dba406636a9d64e6fd1fc8bb041f527362b60bdb7"; // â˜… ç®¡ç†å“¡å¯†ç¢¼ SHA-256 é›œæ¹Š
        window.encryptedData = {"c":"b4ef3c9749b7e5fe958dba89a3b082a7bd70604a6a2a063e465fc70695755411add197be9ed8a15a1922372bc2edfcd9429ee750adecf868c2c467cc6219a0e1cdac55dab619a424ab0111818bc9f2c700b1f68c32fae0726f370e06aec030d3c730a9acf371aea095bf855332bf713a461fdfddd2b5de2bb9bcc9f1d692eeca5e577bc3685bf8a9d57f81d688d7296e66d721e46b78a826315a5ca20db2eb1c41d8cab17e49375cb3e7f4571830c2f2e0a3cd8da6e11648e644f81f0a84db6a1264a445707bc262239284a78c3a4e823bc09e95bd1470c017faf4925cf5620194929de992c04e30ac423134c6e6a56e08ac53d4a96e57d8dd7c2f1cbf924b1f34a27cfa4a25873d38a7135ce8bb43d9d7c751812ab3ac0c5949418a16c6db609e7087aea2fa64497f0ca7dbd3766aaf1520cd3d409487d1a39c4dfb224b2bc5c480895541f8f5e6fa264c228fc95722ad9f46f70c5eecd6b934b077cf151928805c199d09c8da1e48f3c4a192c1a43231096c027949e0e69b53059d2e547af132cddb276831df8dc12d9e6496070cb6747abe5daeee99b79ecd5dad6339e52d4bfcab3b23b8169880b939acca5581ed639b5cb39ed7b1f6447c5624ac149f1a4358dee0a8ff080c59638d2da4d9807f2f0d1771caafd18b56532571ad4023b99a8f3079ba22377caab6e21a48afebffd3e399498d65343ba9173743b3bff7cda01c20d0b123703d79d74efc5e69e63e5e784519296ff30b370ebe0a0a4b74b17d29cc475e76a42c2e8ab893863f70165e54d878fb369b814a867cbc8c0b6549832953053d69aafa3865a81d81856bf3f314a39438e2a094869dcf377873727ea6490450c9bf01fed39627c8a7f8e762d5fd965c3848f03bf684f34898cbb141a8a4df19238e7a798e6700fb5b9312c53d098e2ec7d53b0e496e17834bac87e269d1222ae23792b9579db8518ec98e884bb57d7ad24a05b06ba869641b10f658c008c859452c927214a1af3e25e824ded10b128404bc4920c5925a2ea9ccc1f34cfc5be86fd94256228b9297ebac9a42656d603dd443bd6cd4d21e046c60e89ea0a32a03de868136cae3c0378c9162fb2a513ae11bb5de8a57c87fa58ef4d041660b9e58f039dd8d59d2c973f38fba75692eb268478410da0c97bdae0326541f6260e361d77979681014ac395453ea1713100eb21ad7b5328b37ef12e415605e6601db61fc35cfa3b9eb47a43e82fc187529389f7d2453164258fdcb193c30880e3e74e45385d75a5f7554209ffe37ac8c28da27598b604cef42837f752073e92585b526b545024a862c1ec1543cbc590e821ba773bc651a9506add52d8a3055c0023695dbfb44810ac261f7c75dc9002a15e85834621a196aeed4fb0a5c6ba4f583b47ec7f0acc5d4a35e94e6e37fc71e6ba15527cd91be584b66931dbad2928425469f735c68cf1de652613097e8fcaab430373776a5da5c419e9a64460423753fc7ee460d0acbe46774b28c8d6490d84efcaa30fe5d65c3567e7ed6b4529b07f06df0451f42059bebb7db7b4d1b3e14d64fc47e69bf846059321403d534d8f73a761ec35c6b4a066697065119f2c67829817dbca723577a63f6b5fdfcf3af66addbd7d4eb1217f434ff41122738842634b6c5c2342f307fcd627331ec14fff9c28e6f4bb5601cc951678bca10e79ec0bc066cdedd703ae541834b01460a754792e5b9e3aed310b5c7392be0935928278079e042e70f0320e5e0b47fd61cc8ef99fd4744213665ffe00b1fad0820cd01665b8565f1af3871735fc9077ea80ccb96fe9a4ef28feb2a3fda1f6581184c31059158f405af397884fe4bdf2d0b5f30103edb1eaa0ad80db1c866cc5e73a94b91cd08531e4197e6cf4316aaa7ff1d7abca3b2ec2a0c0a3f7a2ac9c51dfc5fa03587e52de94205052e0edd6b75a2f6755f3b74bded566519ff7e38c637ce158eae460e79381e98c5f059e15edec3d7a242eeada8f939a7f3e15ce8b16548fe4767473ac5ac77842b0b1221e59b7e9eaa1ee1dd2b3f56581b03752b9af34c3695178c0d62a312a95d5664cd6ed7c632212645edd703cad46aa84d4d2e41634a88bcf33be6f63d7d19292860ee576e6cab4e9ee6d160463818f48807d69ed1fbf351ea976101d37060ad36144bf733e0370dd24d6b99c43e49b557d7758e2ccff40b8b63ea7db67b090a82d0f960561024f9fa53bb56ee1044b88b9e170a273e88be3ae00b187a109e45e291f112dd53bbbe60ad85b413974824a567b1b2177f4089224f5231c7189b548c34e39971e8124b97cd68f0d81ddff130578f915bcc3c11f0fc0bacc5d51523daab50814f8e855e4d40a84f6e2108a010af6a73fb004b67d2701e4c26a52b6c031906c43f574ec35d6e69003161d5ec9dc7d376f62d08e092854dba3736ea1d53ff283b49b06261892f5d31cad154e32277e3cd35028b8f36f5d6a8c65c86f0cfafb6db65108f8770a9e91ebe388233ee86db6269e2a08bb548baac3422d4a00185035646f70d74c1f8cd74cb9f641a6892c3d44df1d3027da187b974529608995006bd395395e13e6f5f61a665ff0c552cd2c1b9aed689baf9e589e63517a7a2a11ecc78377dbfc04756ecaeea7f9f1a2e5aafa9a1cd5f171adc5212d53f5aead8e8e0a590df59638ed38a0b4da7a378ed312ff044957c1b0ac6a0c3c513b3a4d9b8421f1c1d7459151f2912819a0ed882f8dc0cd0073b8af140a8360236079c850976c5873793aea0c0668e582ac5cf0e880ae7f0f20e0cc3979f944e9296e3c1b98767d428acb41ab04e406fd8169aab8ee1c0c6b2a4762be57ebdcb5bbbbbc176c60a5cb8edbc2f50540e01da64f31532d1d9199ca8c0a466dfc6df375f8bc065ae13ac5be7ff9ad1f19a92a0c80e738c110287cb8890462aa937c85fd72bad0cdda96b88d2467771249bf826d81d534ede8215041d54320190e0e0d3e322acf94de2eb11699c714a6c269b2804fc3631d1640996472c8e3c931600474cee682c87493fe8383e650e1ae2f6260bf6f6259b54f3df340eafd145e422e38afc197a7751f6df7b1254e7bf5a39cb02ffadc52bec282faa64c4a6a7abb0d55d2c13931235ff86252136dba723951c4d010f545a100dbf5ea9f518fc4a03e6e4778b17dccee9af289fbef83bd78bc99a5af46571dfcca5d502df12918b403093b27664e25ef3d7c397cfe3eaea0ae59f636f2da7d7a316f524fc4c5437e200c6c0ec0ce636551d91954803ff2068ff07ca3ec27108996fecef5bba60ade12831f33a99fccba81a87fb0ce499f95c3722c60d8b64feb0aca237a4caeb8b12c276e4b1e7d0758cd9d97a38e0bc15915f448e79800f2557edbe69c0eeaa7e6b8e8cc1e2533365940d88caf5bcfee82bdaf24718d565ca7b92b44fb16de71fd77a78f6c0f5748254504ee28aca70290d72cc94a34e27b4d0bbf59dcf60642f210e300ba17d7e3fd1815141d5a236d65c4c3d8e1ed92ae410b0eafea727c2473b3938f1552d994b67253979873aed971c4cae4683208948565a71a519f26b4e8337dfd818ae47ff669074ce0e763267eaff6cc4b32680e6efcb1fa2f850a6d205972115ff7a79d1c0ba77409540719e6292f4df4addfb446dc8578f4b45b72857e745a179c6f887d3c984c031e7479d267bc64dcd5dc7cc8d64bea4289c79db130457c9ac3af4551a6ecfd385de118da9c6d09e880fb1a5e9805c46851281919766df8ae729888d933ca62959569f3ed6527ec71de614c9a63198907cff6770b7255ddd4b74f33ed3f17f1c5448b45b0222775914915f58ae20809bb48f7aeb9920ed2bc389d243f954db7394ffc41b2cef9e3d5f3a7b2fa3e381a396a91204625c26a3c029f1e8c993362f2afa43666c490bf4af2b364a3ce3aa08c3e7baabcc0e1aa73e69131cae67c227a88e88f145fa9d6b0b03d2e0efb6f6c3b356cc9927571d3e5f58efd37af9c5441d5810ac9e782c396e4c65a61805352be7e8126fda977da7fe9a6251133b6995367c25847c55e2e786ba6c488b49d687684ab1a6724471d0f1cffd27690f48c5956f2a071b8667785bd6e37dbc5c61e7e3acca799a5fc16dd4d258192e83ad5e330e3bbb681b087602c5ac7597c024f1bd7202c68144b8b76a7f31ec50d39957fbeb0365589e79aa955991f9dbc62e5e1053d42ee1572e413b116f20e830063fe61f8f8231c896c3a2fe4dc26c071ae96c4efc5072d3000b25bc3c6d56a987beba49b62dfadf3b336e9c5914bdad20f365e64d0fdf58372cc2ded58dda5985288a216692fb743ace1a25f9d06a7fe7560c55086af5086eade163695b2a41791f04f7e7304e413ea335fba3ab9ede88b1f20e88e6dc7cb5b82a5cd46cacd59b7e9e76a4cf8d5033d50fa8625e92a10b818c6ffbebfb3d86510534b72968c2c193ad0e31dee41d00c345cb5a9cd18e821aac3192b547e0c342070b2148565d5073d763bdb1064a0135fcbbedbbfc143bdcb1b3a7cfe5afb0e919c6384008761265ccf6ed970532895d0343681ac540e4b7c7606141276874a5397fc5aeab67ec8831551d8b756a077ca5446b30231bbadae9a516c1eac53bc796e4aaeac837679061561b7fd2d1e9955203a0e1500b7f80c066684f3909361c7e9bfe46bb23aca7d497d6fb567bb96be5ed67edc4bf7e49f50b1d6bbed513d3923d8a8d5b0607e1d9f83f17442c1c56fe1af4249df4b3096e83a09477c3b1f06fa96c792d002b1cddd110d7cc9d220e4ba072a2a53263aa549e507f2fef3272cfc2eeb232e7cb18b6e35899f4192785a29931bc449eac61e733da651e5d3d60762060a99a92fecf15c44dc502e66c56bec2822d67597aaf0b3764e0290b4860a6dbe41e07bd58bd03ed55b85fb3d52ac5d4814463790ed3dfeaae2e3632ab4de87037430c62b4f5f6d3f6d25feccee6766b2db716f795fa88e4d24cfcad7cdaaf95bd8ed3f4fbcbb2907255f3b78fbf14bdf5f53aff3fc9f39c282ee44cde63b78741ee345639b2fc51e375b3ac7fbf7d42901efb359b0bbf90a129c6d90a69016569981410da6d6e7282c4e85acca09f6621f2d8ad8d11b76cf971d917efe844a5cb9f37f9462750f1d261ebd22f0a1a0d3e96ec2962656099859bf04d51515ac906a292c61d9cae4ca0a348b44faeb69c55c35f6c5166bd955117f917a2028c558db4100e8f2e1b9194d4792d2be359ba4db4514c8058c15a4be558ad2c1e719af7c5131c2384e3e0ea57aec8d73f140aa1dece1d216b150f3609d7f5b4a8d1bd4f1c486f9b01016037e823bfb9ad15283bd32918c319f1cb07c4babe862f85dfdefde4ad34f67b859dec32db22c3929dbb417ab97156819358ff696ce1c5f373f613a058262097663f048085264e78c201942cca7369a43208ce14b039504afb8a19ff8ce49a6a6f06e8c9a5780ae41e29356862649e9f9dba5bb986fe95ba03f5b0c687dcec89add8d3d62ca8f5749d8a5d406a61b1c892c08a1baa8c0b991ea58b083d32742ba6caf92c42f722caba06387af45863e880d5ce04ec17a0383e6fd73c7e805009591c39785d827418b2e232a32192c388ae796276da8f724923a824722199b4c0203bfbec7e595bd571cbfcc70fb4ee0c97f068f4e92ddf37db83092f91da8e582695088a84b6bb88f2dc3a4ad7274cbc75fddba07bfee0c71f02a97a509faa5bd81e5209ac9cf8f81956fd037a5bec43cfb0d67045faddc084427031ca346e994d33da4256267ecffdaf0084e1533e8ebc5db84095f11a88a39446fc053106d34c96f154e0211f0b5555a6f6a68877a12a772787df3445599208631da6056bdb9dfc19be1fc7e718ff7a114dd3e0ba9a3ce29b6856deb51374d1a9290d17cc672519d1b9e0de671a442d7186251fa421a781d8933fde41c5d06553a14ec698c60dd286424e28eb1c5a09baf4051fbe6f5122365e8c9e36116bd20fc150c5c4ccb7a4b658bd2e50c58cb095aae10a6ec0e9dae682df31cb52e9a9e1d616520e0ce32af8ae35bea5b35b40ebe120c559fac53a0753664cf3b688faca95f0ac79060eb13bb68aafa510fb95688c8889f9d3ea6eddad0bfbec794569f8732cdfa6f66cac7fffb2c148b6f2d22bd8e561e11bee00194f9882813bf5fa153fbbd1ccf248a9b5dfa297ad1d24557d6d0e993c00a234da9563f03663c57b6cc78a19fbfe3c63d78c9a7e08fbebb24c452ede0921119c176e2e62f9e107b6618b081869c77e99f668deb8b4486353598ffd61255e94baa87c07c5edfe789f09e43f3c86e3a7143830057d79bd7a66d8b6ad69d9df4707004388c91a9c0507ce9220eb2293e5489b9e33ef325c83ae7e2be5683eae3068996d2a758e896458fbb0414ed4e9ccd38889071ace530d61d7aca1204f83c6ceb303f2503e111247249cbfb2fe93a2f50f615becb43913739dcdf4ecd54507e4c0db27f6daa01d1e19ccb67938f6666c01fa300405716e8442f234642efd7399f3c9e6b48e3b700b57b084ad733f6a89e733235b80e0721b5f72f4096e9a136e022f0791f5195e3ea72c95636c88e0cbc9c5f566ab49ab239a06958077fa812c6de78e70cf1f03c3352ee44a921995c69e3109754a661076d41182c977be6937e73068f794d1fe3175f99b12e14a6aeac9be682dd1a7db4bc2436430abb6bf567ba955c7e5023914d008948ded9cef6a436f7b2c84f7c78009650e58de88c1112ea254b68d5011647f98ec4f43ef051a22be4f9d470747707daf985d9c220dec12aaeb1291703ef9033c5a65b0c7117b04e07172f00108635d482cca353d4405134d4782191821c5603ac7444d09a24287c1bd2c37b133518fea809314328a90742f9131cb2fdd83d21a7d9740808f569abdb8fc5aaf47b1a77ddf945f71bf5f5de4aa65af9183dffd1ba0a94775dad699607e89578bbe7828a1cb708e33d5ba185e48305eea142b1e4e32c5273a6160e8a6bbe4a3958ba4f7e65265def909cd6311285f207b156ee0ff912f9235545d41ce58975025d73298f52862161f6be85cc98a3b692983809f7f93a24fca7c9c23b21a2624d11fd1b2efbb3e086bc9c99b48d50657022e246e74c41fc2002d75bf5cce798998c0056b35bc352fcdd370d5344c4f3a706933a65d9d30c8e75aa3cd57569e0da9bde9d8fd503a269848536b7013695464917640475941556d01f6377a5ff735de94cd6810ee16dedc8367ee12be44c0e88e2f68469dfdd1c0304e10c20e6b1a7e653791d0248c138467b40f5441e81fd9a9be1a009d2df76cc51757fa9daad5b1f6808e88384934704b1f0e41b3350ef1fe9eefbdc51bc2ebf9e1b22d95b40363af99a883f3a29196af90c70123c184169d3187867e3ac1b7f66c9448ee2a69ab89a0553322c3f1f247b5dfccde804fad6e161af0e1c22b43d7b95715925fbaf8639987fd7a3716a8bb5117b1fafa8eb78c48b23231d0c4c405b51df5ffc2608cec8e84ced6e93dd22c7fb36a717a3d5ece14b880a36c9b55c0aa82b6ec773ca70e61f93a17b78c174b8d45d968ba7bb1467d33cd23e52a0b26d5ffc028c59fca1c42","s":"46bd8925972cc35973ce796c9169332d","i":"cff63f8208a5becd301b783d"};
        
        let isVIP=false,passwordAttempts=0,unlockClickCount=0;const MAX_ATTEMPTS=3;
        
        window.bakedData=null;let cardsData=[],styleConfig={},textLibrary=[];
        const defaultStyle={fontTitle:"'Noto Serif TC', serif",fontBody:"'Noto Sans TC', sans-serif",paperColor:"#f9f6ea",textureOpacity:"0.5"};
        let currentScaleFactor=1,viewingStartIndex=0,currentEditId=null,selectedLibIndex=-1;
        const hex2buf=(h)=>new Uint8Array(h.match(/.{1,2}/g).map(b=>parseInt(b,16)));

        async function checkPassword(){
            if(passwordAttempts>=MAX_ATTEMPTS)return;
            const input=document.getElementById('access-input').value.trim();
            const errorMsg=document.getElementById('error-msg');
            const enc=new TextEncoder();
            if(!input)return;
            try{
                const hBuf=await window.crypto.subtle.digest("SHA-256",enc.encode(input));
                const hHex=[...new Uint8Array(hBuf)].map(x=>x.toString(16).padStart(2,'0')).join('');
                if(hHex===_p_h){
                    await decryptAndLoad(input);
                    passwordAttempts=0;
                    document.getElementById('start-overlay').style.opacity=0;
                    setTimeout(()=>document.getElementById('start-overlay').style.display='none',500);
                    // ä¸€èˆ¬ç”¨æˆ¶ç™»å…¥ï¼Œå…ˆä¸çµ¦ VIP
                    isVIP=false;
                }else{throw new Error("Password mismatch");}
            }catch(e){
                passwordAttempts++;errorMsg.innerText=`å¯†ç¢¼éŒ¯èª¤ ${passwordAttempts} æ¬¡`;errorMsg.style.opacity=1;
                document.getElementById('access-input').value='';document.getElementById('access-input').focus();
                if(passwordAttempts>=MAX_ATTEMPTS)lockSystem();
            }
        }
        async function decryptAndLoad(p){
            try{
                if(!window.encryptedData){alert("No data");return;}
                const d=window.encryptedData;
                const enc=new TextEncoder();
                const kMat=await window.crypto.subtle.importKey("raw",enc.encode(p),{name:"PBKDF2"},false,["deriveKey"]);
                const key=await window.crypto.subtle.deriveKey({"name":"PBKDF2",salt:hex2buf(d.s),iterations:100000,hash:"SHA-256"},kMat,{"name":"AES-GCM",length:256},true,["decrypt"]);
                const decBuf=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:hex2buf(d.i)},key,hex2buf(d.c));
                window.bakedData=JSON.parse(new TextDecoder().decode(decBuf));
                initData();
            }catch(e){alert("Decryption failed");console.error(e);}
        }
        
        function initData(){
            if(window.bakedData){cardsData=window.bakedData.cards||[];styleConfig=window.bakedData.style||defaultStyle;textLibrary=window.bakedData.library||[];}else{return;}
            applyStyles();
            renderCards();
            initStackInteraction(); 
            renderSidebar();initAdminUI();renderLibraryList();adjustLayout();
        }
        function adjustLayout(){const w=window.innerWidth,h=window.innerHeight,s=document.getElementById('card-stack'),ap=document.getElementById('admin-panel');if(ap.style.display==='flex'){const lc=w*0.35,sc=Math.min((lc*0.85)/360,0.8);s.style.left=(lc/2)+'px';s.style.top=(h*0.55)+'px';s.style.transform=`translate(-50%, -50%) scale(${sc})`;currentScaleFactor=sc;return;}const isP=h>w,sc=isP?(w*0.96)/375:Math.min((h*0.95)/660,1.2);currentScaleFactor=Math.max(0.6,Math.min(sc,2.0));s.style.left='50%';s.style.top='50%';s.style.transform=`translate(-50%, -50%) scale(${currentScaleFactor})`;}
        window.addEventListener('resize',adjustLayout);
        function applyStyles(){document.documentElement.style.setProperty('--card-bg',styleConfig.paperColor);document.getElementById('global-paper-color').value=styleConfig.paperColor;}
        function updateMemoryState(){applyStyles();renderCards();renderSidebar();}
        function startPasswordAnimation(){document.getElementById('trigger-btn').style.opacity='0';document.getElementById('trigger-btn').style.pointerEvents='none';const ps=document.getElementById('password-section');ps.style.display='flex';setTimeout(()=>{ps.classList.add('active');setTimeout(()=>{const i=document.getElementById('access-input');if(i.style.display!=='none')i.focus();},2000);},50);}
        function lockSystem(){document.getElementById('password-section').style.display='none';document.getElementById('password-section').classList.remove('active');document.getElementById('lock-message').style.display='flex';}
        document.getElementById('lock-text').addEventListener('click',function(e){e.preventDefault();unlockClickCount++;if(unlockClickCount>=5){unlockClickCount=0;passwordAttempts=0;document.getElementById('lock-message').style.display='none';document.getElementById('error-msg').style.opacity=0;document.getElementById('access-input').value='';startPasswordAnimation();}});
        document.getElementById('access-input').addEventListener('keypress',function(e){if(e.key==='Enter')checkPassword();});
        function renderCards(){const c=document.getElementById('card-stack');c.innerHTML='';cardsData.forEach((d,i)=>{const card=document.createElement('div');card.className='card';if(d.type==='total_toc')card.classList.add('print-full-page');card.style.setProperty('--text-color',d.color||'#594a42');card.style.color='var(--text-color)';let inner=`<div class="card-sheen"></div><div class="card-content w-full h-full relative"><div class="card-page-num">${i+1}</div>`;if(d.type!=='total_toc')inner+=`<button onclick="jumpToTOC()" class="back-btn" title="Back">back</button>`;if(!['cover','chapter','total_toc'].includes(d.type))inner+=`<div class="absolute top-6 right-6 writing-vertical text-xs tracking-widest opacity-50 border-l border-current pl-2" style="writing-mode: vertical-rl; border-color: var(--text-color);">${d.tag||''}</div>`;
        const parseLink=s=>{if(!s)return{text:'',url:'#'};const p=s.split('##');let t=p[0].trim().replace(/\[link:(.*?)\](.*?)\[\/link\]/g,'<a href="$1" target="_blank" style="text-decoration:underline;">$2</a>').replace(/\[color:(.*?)\](.*?)\[\/color\]/g,'<span style="color:$1">${2}</span>');return{text:t,url:p[1]?p[1].trim():null};};
        const getTitle=t=>`<span style="font-size:${d.titleScale||'100'}%">${t}</span>`;
        switch(d.type){
            case 'total_toc':inner+=`<div class="w-full h-full flex flex-col pt-16 px-8 overflow-hidden"><h2 class="text-2xl font-bold mb-6 tracking-widest text-center font-title border-b border-current pb-4">${getTitle(d.title)}</h2><div class="overflow-y-auto pr-2 space-y-3 h-full custom-scrollbar">`+cardsData.map((c,x)=>c.id===d.id?'':`<div onclick="jumpToCard('${c.id}')" class="cursor-pointer border-b border-dotted border-current/30 pb-1 hover:bg-black/5 transition flex justify-between items-end"><span class="text-sm font-bold opacity-80 truncate mr-2">${c.title||'ç„¡æ¨™é¡Œ'}</span><span class="text-xs opacity-50 font-mono">P.${x+1}</span></div>`).join('')+`</div></div>`;break;
            case 'cover':{const{text,url}=parseLink(d.content);inner+=`<div class="flex flex-col items-center justify-center h-full text-center px-4"><div class="mb-4 text-xs tracking-[0.4em] opacity-60 border-b border-current pb-2" style="border-color: var(--text-color);">${d.tag||'COVER'}</div><h1 class="text-5xl font-bold mb-6 tracking-widest leading-snug font-title">${getTitle(d.title)}</h1><div class="w-12 h-1 bg-current opacity-20 mb-8"></div><p class="text-xl font-serif italic tracking-widest opacity-80 whitespace-pre-wrap font-body">${url?`<a href="${url}" target="_blank" class="text-link">${text}</a>`:text}</p></div>`;break;}
            case 'intro':inner+=`<div class="w-full h-full flex flex-col pt-16 px-8"><h2 class="text-3xl font-bold mb-8 tracking-widest font-title">${getTitle(d.title)}</h2><div class="text-base leading-loose text-left opacity-90 whitespace-pre-wrap font-body">${parseLink(d.content).text}</div></div>`;break;
            case 'toc':inner+=`<div class="w-full h-full flex flex-col pt-16 px-8"><h2 class="text-2xl font-bold mb-10 tracking-widest border-b border-current pb-4 text-center font-title">${getTitle(d.title)}</h2><div class="space-y-4 font-body">`+(d.list||[]).map(l=>{const{text,url}=parseLink(l);return`<div class="flex items-end"><span class="font-bold opacity-80">${text}</span><div class="flex-grow border-b-2 border-dotted border-current opacity-30 mx-2 mb-1"></div><span class="font-serif opacity-60">${url||''}</span></div>`}).join('')+`</div></div>`;break;
            case 'chapter':inner+=`<div class="w-full h-full flex flex-col items-center justify-center relative overflow-hidden"><div class="absolute text-[200px] font-serif opacity-5 select-none" style="top:50%; left:50%; transform:translate(-50%, -50%);">${d.tag}</div><h2 class="text-sm tracking-[0.5em] mb-4 opacity-60 uppercase">CHAPTER ${d.tag}</h2><h1 class="text-4xl font-bold tracking-widest font-title border-y-2 border-current py-6 px-4">${getTitle(d.title)}</h1><p class="mt-6 tracking-widest opacity-60">${parseLink(d.content).text}</p></div>`;break;
            case 'quote':inner+=`<div class="flex flex-col items-center justify-center h-full text-center px-8"><i class="fas fa-quote-left text-3xl opacity-20 mb-6"></i><h2 class="text-2xl font-serif leading-loose tracking-widest opacity-90 whitespace-pre-wrap font-title">${parseLink(d.content).text}</h2><div class="mt-8 w-full text-right font-bold opacity-60 text-sm"><span>â€” ${getTitle(d.title)}</span></div></div>`;break;
            case 'standard':inner+=`<div class="w-full h-full flex flex-col pt-16 px-8"><h2 class="text-3xl font-bold mb-10 tracking-widest font-title decoration-wavy underline decoration-current/30 underline-offset-8">${getTitle(d.title)}</h2><ul class="space-y-5 font-body">`+(d.list||[]).map(l=>`<li class="flex items-start"><span class="mr-3 mt-2 w-1.5 h-1.5 rounded-full bg-current opacity-60 flex-shrink-0"></span><span class="text-lg opacity-90 leading-relaxed">${parseLink(l).text}</span></li>`).join('')+`</ul></div>`;break;
            case 'numbered':inner+=`<div class="w-full h-full flex flex-col pt-14 px-6"><h2 class="text-2xl font-bold mb-8 tracking-widest font-title border-b border-current pb-2">${getTitle(d.title)}</h2><div class="space-y-6">`+(d.list||[]).map((l,i)=>`<div class="flex items-start gap-4"><div class="w-8 h-8 rounded-full border border-current flex items-center justify-center flex-shrink-0 font-serif font-bold opacity-80">${i+1}</div><div class="pt-1 text-lg opacity-90 font-body">${parseLink(l).text}</div></div>`).join('')+`</div></div>`;break;
            case 'checklist':inner+=`<div class="w-full h-full flex flex-col pt-16 px-8"><h2 class="text-2xl font-bold mb-8 tracking-widest font-title text-center bg-black/5 py-2 rounded">${getTitle(d.title)}</h2><div class="space-y-4">`+(d.list||[]).map(l=>`<div class="flex items-center gap-3 p-2 border-b border-current/20"><i class="far fa-check-square text-xl opacity-60"></i><span class="text-lg opacity-90">${parseLink(l).text}</span></div>`).join('')+`</div></div>`;break;
            case 'grid':inner+=`<div class="w-full h-full flex flex-col pt-16 px-4"><h2 class="text-2xl font-bold mb-8 tracking-widest opacity-90 text-center font-title">${getTitle(d.title)}</h2><div class="grid grid-cols-2 gap-4 w-full">`+(d.list||[]).map(l=>{const{text,url}=parseLink(l);return`<div class="grid-box h-24 flex items-center justify-center cursor-pointer hover:bg-black/5" onclick="${url?`window.open('${url}')`:''}"><span class="font-bold text-lg opacity-80 font-body">${text}</span></div>`}).join('')+`</div></div>`;break;
            case 'grid3':inner+=`<div class="w-full h-full flex flex-col pt-16 px-4"><h2 class="text-2xl font-bold mb-6 tracking-widest opacity-90 text-center font-title">${getTitle(d.title)}</h2><div class="grid grid-cols-2 gap-3 w-full">`+(d.list||[]).map(l=>`<div class="border border-current rounded p-3 text-center flex items-center justify-center aspect-[4/3]"><span class="font-bold opacity-80 leading-tight">${parseLink(l).text}</span></div>`).join('')+`</div></div>`;break;
            case 'stat':{const p=d.content.split('##');inner+=`<div class="w-full h-full flex flex-col items-center justify-center px-6"><h3 class="text-xl tracking-widest opacity-60 mb-6 uppercase">${getTitle(d.title)}</h3><div class="text-6xl font-bold font-serif mb-4 tracking-tighter">${p[0]}</div><div class="text-lg opacity-80 font-body bg-current text-white px-4 py-1 rounded-full" style="background-color: var(--text-color);">${p[1]||''}</div></div>`;break;}
            case 'keyvalue':inner+=`<div class="w-full h-full flex flex-col justify-center px-6"><h2 class="text-center text-2xl font-bold mb-10 tracking-widest opacity-90 font-title">${getTitle(d.title)}</h2><div class="space-y-4 w-full">`+(d.list||[]).map(l=>{const{text,url}=parseLink(l);return`<div class="key-value"><span class="text-lg font-medium opacity-80 w-full flex justify-between font-body">${text}<span class="font-bold">${url||''}</span></span></div>`}).join('')+`</div></div>`;break;
            case 'chart':{const mv=Math.max(...(d.list||[]).map(l=>parseFloat(l.split('##')[1])||0));inner+=`<div class="w-full h-full flex flex-col pt-16 px-6"><h2 class="text-2xl font-bold mb-8 tracking-widest text-center font-title">${getTitle(d.title)}</h2><div class="flex-1 flex flex-col justify-center">`+(d.list||[]).map(l=>{const p=l.split('##');return`<div class="bar-container"><div class="bar-label font-bold">${p[0]}</div><div class="bar-track"><div class="bar-fill" style="width: ${(parseFloat(p[1])||0)/mv*100}%"></div></div><div class="bar-value">${parseFloat(p[1])||0}</div></div>`}).join('')+`</div></div>`;break;}
            case 'comparison':inner+=`<div class="w-full h-full flex flex-col pt-14 px-4"><h2 class="text-2xl font-bold mb-6 tracking-widest text-center font-title">${getTitle(d.title)}</h2><div class="flex-1 border-t-2 border-b-2 border-current py-4 overflow-hidden"><div class="grid grid-cols-2 h-full divide-x divide-current/30"><div class="px-2 space-y-4 text-center"><div class="font-bold text-sm opacity-50 mb-2">ä¸€èˆ¬æ–¹æ¡ˆ</div>`+(d.list||[]).map(l=>`<div class="text-sm py-2 border-b border-dotted border-current/20 h-16 flex items-center justify-center">${parseLink(l.split('##')[0]).text}</div>`).join('')+`</div><div class="px-2 space-y-4 text-center"><div class="font-bold text-sm opacity-50 mb-2">æœ¬æ–¹æ¡ˆ</div>`+(d.list||[]).map(l=>`<div class="text-sm font-bold py-2 border-b border-dotted border-current/20 h-16 flex items-center justify-center">${parseLink(l.split('##')[1]||'').text}</div>`).join('')+`</div></div></div></div>`;break;
            case 'table':inner+=`<div class="w-full h-full flex flex-col pt-16 px-6"><h2 class="text-2xl font-bold mb-6 tracking-widest text-center font-title">${getTitle(d.title)}</h2><table class="w-full text-sm border-collapse"><thead><tr class="border-b-2 border-current"><th class="py-2 text-left w-1/2">é …ç›®</th><th class="py-2 text-right">å…§å®¹</th></tr></thead><tbody>`+(d.list||[]).map(l=>{const p=l.split('##');return`<tr class="border-b border-current/10"><td class="py-3 font-bold opacity-80">${parseLink(p[0]).text}</td><td class="py-3 text-right opacity-90">${parseLink(p[1]||'').text}</td></tr>`}).join('')+`</tbody></table></div>`;break;
            case 'timeline':inner+=`<div class="w-full h-full flex flex-col pt-14 px-8"><h2 class="text-2xl font-bold mb-8 tracking-widest opacity-90 border-b border-current pb-2 font-title">${getTitle(d.title)}</h2><div class="pl-2">`+(d.list||[]).map(l=>`<div class="timeline-item"><div class="font-bold text-lg opacity-90 font-body">${parseLink(l).text}</div></div>`).join('')+`</div></div>`;break;
            case 'process':inner+=`<div class="w-full h-full flex flex-col pt-16 px-6"><h2 class="text-2xl font-bold mb-10 tracking-widest text-center font-title">${getTitle(d.title)}</h2><div class="flex-1 flex flex-col gap-4">`+(d.list||[]).map((l,i)=>`<div class="flex items-center"><div class="w-full border border-current rounded p-3 text-center font-bold relative">${parseLink(l).text}${i<(d.list.length-1)?`<div class="absolute -bottom-5 left-1/2 -translate-x-1/2 text-current"><i class="fas fa-arrow-down"></i></div>`:''}</div></div>${i<(d.list.length-1)?`<div class="h-4"></div>`:''}`).join('')+`</div></div>`;break;
            case 'qa':inner+=`<div class="w-full h-full flex flex-col pt-14 px-6"><h2 class="text-2xl font-bold mb-6 tracking-widest text-center font-title decoration-4 underline decoration-current/20">${getTitle(d.title)}</h2><div class="space-y-6 overflow-y-auto">`+(d.list||[]).map(l=>{const p=l.split('##');return`<div><div class="font-bold text-lg mb-1 flex gap-2"><span class="opacity-50">Q.</span><span>${parseLink((p[0]||'').replace('Q:','').trim()).text}</span></div><div class="text-sm opacity-80 pl-6 border-l-2 border-current/30 ml-1 py-1">${parseLink((p[1]||'').replace('A:','').trim()).text}</div></div>`}).join('')+`</div></div>`;break;
            case 'warning':inner+=`<div class="w-full h-full flex flex-col justify-center px-6"><div class="border-2 border-current p-6 relative"><span class="absolute -top-3 left-4 bg-[#f9f6ea] px-2 font-bold tracking-widest text-sm opacity-80 font-title" style="background-color: var(--card-bg);">${getTitle(d.title)}</span><ul class="list-disc pl-5 space-y-3 opacity-80 font-medium font-body text-sm leading-relaxed">`+(d.list||[]).map(l=>`<li>${parseLink(l).text}</li>`).join('')+`</ul></div></div>`;break;
            case 'contact':{const{text,url}=parseLink(d.content);inner+=`<div class="w-full h-full flex flex-col items-center justify-center px-6 text-center"><div class="w-20 h-20 rounded-full border-2 border-current flex items-center justify-center mb-6 text-3xl opacity-80"><i class="fas fa-user"></i></div><h2 class="text-2xl font-bold mb-6 tracking-widest font-title">${getTitle(d.title)}</h2><p class="text-lg opacity-80 whitespace-pre-wrap leading-loose font-body">${url?`<a href="${url}" target="_blank" class="text-link">${text}</a>`:text}</p></div>`;break;}
        }
        inner+=`</div>`;card.innerHTML=inner;card.style.touchAction="none";
        if(i===viewingStartIndex){card.style.display='flex';card.style.transform='scale(1)';card.style.opacity=1;card.style.zIndex=100;card.style.pointerEvents='auto';}else if(i>viewingStartIndex&&i-viewingStartIndex===1){card.style.display='flex';card.style.transform='scale(0.98)';card.style.opacity=0.5;card.style.zIndex=99;card.style.pointerEvents='none';}else{card.style.display='none';}c.appendChild(card);});
        
        initStackInteraction(); 
        
        // â˜… æ ¸å¿ƒé‚è¼¯ï¼šåªåœ¨é‡è¦è²æ˜é é¢é¡¯ç¤ºé½’è¼ª
        const ab=document.getElementById('admin-btn');
        if(cardsData[viewingStartIndex]&&(cardsData[viewingStartIndex].type==='warning'||cardsData[viewingStartIndex].title.includes('é‡è¦è²æ˜'))) ab.style.display='flex';
        else ab.style.display='none';
        }
        
        function initStackInteraction(){
            const stack = document.getElementById('card-stack');
            if(stack._handleDown) stack.removeEventListener('pointerdown', stack._handleDown);

            let isDragging = false, startX = 0, currentX = 0, activeCard = null;

            const handleDown = (e) => {
                if(e.target.closest('a') || e.target.closest('button') || e.target.closest('.cursor-pointer')) return;
                
                const allCards = document.querySelectorAll('.card');
                if(!allCards[viewingStartIndex]) return;
                
                activeCard = allCards[viewingStartIndex];

                if(!activeCard.contains(e.target)) return;

                isDragging = true;
                startX = e.clientX;
                activeCard.style.transition = 'none';
                try{ activeCard.setPointerCapture(e.pointerId); } catch(err){}
                
                document.addEventListener('pointermove', handleMove);
                document.addEventListener('pointerup', handleUp);
                document.addEventListener('pointercancel', handleUp);
            };

            const handleMove = (e) => {
                if(!isDragging || !activeCard) return;
                e.preventDefault(); 
                
                const tx = (e.clientX - startX) / currentScaleFactor;
                
                if(viewingStartIndex === 0 && tx > 50) return;
                if(viewingStartIndex === cardsData.length - 1 && tx < -50) return;
                
                currentX = tx;
                if(Math.abs(currentX) > 0) {
                    activeCard.style.transform = `translateX(${currentX}px) rotate(${currentX * 0.05}deg)`;
                }
            };

            const handleUp = (e) => {
                if(!isDragging || !activeCard) return;
                isDragging = false;
                
                document.removeEventListener('pointermove', handleMove);
                document.removeEventListener('pointerup', handleUp);
                document.removeEventListener('pointercancel', handleUp);
                
                activeCard.style.transition = 'transform 0.6s cubic-bezier(0.2, 0.8, 0.2, 1)';
                
                if(Math.abs(currentX) > 80) {
                    const dir = currentX > 0 ? 1 : -1; 
                    activeCard.style.transform = `translateX(${dir === 1 ? 1200 : -1200}px) rotate(${dir * 15}deg)`;
                    setTimeout(() => changePage(dir), 200);
                } else {
                    activeCard.style.transform = 'translate(0,0)';
                }
                currentX = 0;
                activeCard = null;
            };

            stack._handleDown = handleDown;
            stack.addEventListener('pointerdown', handleDown);
        }
        
        window.changePage=d=>{const n=viewingStartIndex-d;if(n<0||n>=cardsData.length)return;viewingStartIndex=n;renderCards();};
        window.jumpToCard=id=>{const i=cardsData.findIndex(c=>c.id===id);if(i!==-1){viewingStartIndex=i;renderCards();}};
        window.jumpToTOC=()=>{const t=cardsData.find(c=>c.type==='total_toc');if(t)jumpToCard(t.id);};
        function initAdminUI(){
            document.getElementById('global-paper-color').addEventListener('input',e=>{styleConfig.paperColor=e.target.value;applyStyles();});
            
            // â˜… ä¿®æ”¹ï¼šæ”¹ç‚º SHA-256 é©—è­‰
            document.getElementById('admin-btn').onclick = async () => {
                if(isVIP){
                    openAdmin();
                } else {
                    const input = prompt("è«‹è¼¸å…¥ç®¡ç†å“¡å¯†ç¢¼:");
                    if(input !== null) {
                        try {
                            const enc = new TextEncoder();
                            const buf = await window.crypto.subtle.digest("SHA-256", enc.encode(input));
                            const hex = [...new Uint8Array(buf)].map(x => x.toString(16).padStart(2,'0')).join('');
                            if (hex === _a_h) {
                                isVIP = true;
                                alert("é©—è­‰æˆåŠŸï¼");
                                openAdmin();
                            } else {
                                alert("å¯†ç¢¼éŒ¯èª¤ï¼Œæ‹’çµ•å­˜å–ï¼");
                            }
                        } catch(e) {
                            console.error(e);
                            alert("é©—è­‰éŒ¯èª¤");
                        }
                    }
                }
            };
            
            document.getElementById('close-admin-btn').onclick=()=>{document.getElementById('admin-panel').style.display='none';adjustLayout();};
            document.getElementById('add-page-btn').onclick=()=>{cardsData.push({id:'c_'+Date.now(),type:'standard',title:'æ–°é é¢',tag:'NEW',list:['å…§å®¹...']});updateMemoryState();};
            document.getElementById('reset-data-btn').onclick=()=>{if(confirm('é‡ç½®?'))location.reload();};
            document.getElementById('delete-page-btn').onclick=()=>{if(confirm('åˆªé™¤?')){cardsData=cardsData.filter(c=>c.id!==currentEditId);viewingStartIndex=Math.max(0,viewingStartIndex-1);updateMemoryState();showEditor(false);}};
            document.getElementById('apply-change-btn').onclick=applyEdit;
            document.getElementById('edit-title-scale').addEventListener('change',function(){if(this.value==='custom'){const v=prompt("æ¯”ä¾‹?");if(v){this.add(new Option(v+'%',v),this.lastChild);this.value=v;}applyEdit();}});
            document.getElementById('print-file-btn').onclick=()=>document.getElementById('print-settings-modal').classList.remove('hidden');
            window.closePrintModal=()=>document.getElementById('print-settings-modal').classList.add('hidden');
            window.executePrint=()=>{window.print();closePrintModal();};
            document.getElementById('save-file-btn').onclick=()=>{alert("âš ï¸ å®‰å…¨æç¤ºï¼šæ­¤ç‚ºæœ€çµ‚äº¤ä»˜ç‰ˆï¼Œåƒ…ä¾›ç€è¦½ã€‚å¦‚éœ€ä¿®æ”¹ï¼Œè«‹ä½¿ç”¨åŸå§‹ç·¨è¼¯å™¨ã€‚");};

            // â˜… æ–°å¢ï¼šåŒ¯å‡º JSON åŠŸèƒ½
            document.getElementById('export-json-btn').onclick = () => {
                // 1. åŒæ­¥ç•¶å‰ç·¨è¼¯ç‹€æ…‹åˆ°å…¨åŸŸç‰©ä»¶
                if(!window.bakedData) return;
                window.bakedData.cards = cardsData;
                window.bakedData.style = styleConfig;
                window.bakedData.library = textLibrary;
                
                // 2. è½‰æˆ Blob
                const str = JSON.stringify(window.bakedData, null, 2);
                const blob = new Blob([str], {type: "application/json"});
                const url = URL.createObjectURL(blob);
                
                // 3. ä¸‹è¼‰
                const a = document.createElement('a');
                a.href = url;
                let fName = "data_export.json";
                if(window.bakedData.clientInfo) {
                    fName = `data_${window.bakedData.clientInfo.name}_${window.bakedData.clientInfo.id}.json`;
                }
                a.download = fName;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            };
        }
        function openAdmin(){document.getElementById('admin-panel').style.display='flex';renderSidebar();adjustLayout();showEditor(false);}
        function renderSidebar(){const l=document.getElementById('page-list-container');l.innerHTML='';cardsData.forEach((c,i)=>{const d=document.createElement('div');d.className=`admin-card-item ${c.id===currentEditId?'active':''}`;d.onclick=()=>selectCard(c.id);d.innerHTML=`<span class="bg-gray-200 text-xs w-6 h-6 flex items-center justify-center rounded-full mr-2">${i+1}</span><div class="truncate text-sm font-bold text-gray-700 flex-1">${c.title}</div>`;l.appendChild(d);});}
        function selectCard(id){currentEditId=id;renderSidebar();const c=cardsData.find(x=>x.id===id);if(!c)return;document.getElementById('edit-type').value=c.type;document.getElementById('edit-title').value=c.title;document.getElementById('edit-tag').value=c.tag||'';document.getElementById('edit-color').value=c.color||'#594a42';if(['cover','intro','chapter','quote','stat','contact'].includes(c.type))document.getElementById('edit-content').value=c.content||'';else document.getElementById('edit-content').value=(c.list||[]).join('\n');showEditor(true);jumpToCard(id);}
        function showEditor(s){document.getElementById('editor-form').className=s?'w-full bg-white p-6 rounded-xl shadow-sm border border-gray-200':'hidden';document.getElementById('editor-empty').className=s?'hidden':'h-full flex flex-col items-center justify-center text-gray-400';}
        function applyEdit(){const c=cardsData.find(x=>x.id===currentEditId);if(!c)return;c.type=document.getElementById('edit-type').value;c.title=document.getElementById('edit-title').value;c.tag=document.getElementById('edit-tag').value;c.color=document.getElementById('edit-color').value;c.titleScale=document.getElementById('edit-title-scale').value;const v=document.getElementById('edit-content').value;if(['cover','intro','chapter','quote','stat','contact'].includes(c.type)){c.content=v;delete c.list;}else{c.list=v.split('\n');delete c.content;}updateMemoryState();alert('å·²ä¿®æ”¹ (æš«å­˜)');}
        function renderLibraryList(){const d=document.getElementById('lib-list-container');d.innerHTML='';textLibrary.forEach((t,i)=>{const b=document.createElement('div');b.className='lib-item '+(i===selectedLibIndex?'active':'');b.innerText=t.content;b.onclick=()=>{selectedLibIndex=i;renderLibraryList();};d.appendChild(b);});}
        function lib_add_new(){const v=document.getElementById('lib-new-content').value;if(v){textLibrary.push({content:v});renderLibraryList();}}
        function lib_insert_at_cursor(){if(selectedLibIndex<0)return;const t=textLibrary[selectedLibIndex].content;const e=document.getElementById('edit-content');e.setRangeText(t,e.selectionStart,e.selectionEnd,'end');}
        function lib_delete(){if(selectedLibIndex>=0){textLibrary.splice(selectedLibIndex,1);selectedLibIndex=-1;renderLibraryList();}}
        window.insertLink=()=>{const u=prompt('URL?');if(u)document.getElementById('edit-content').setRangeText(`[link:${u}]é€£çµæ–‡å­—[/link]`);};
        window.insertColorCode=(c)=>document.getElementById('edit-content').setRangeText(`[color:${c}]æ–‡å­—[/color]`);
        
    </script>
</body>
</html>